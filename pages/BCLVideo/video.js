/**
 * Created by yafengxu on 17/1/9.
 */
{if("undefined"==typeof SOTool)var SOTool={},SOTool={PluginStack:{},JsList:{},shareObj:function(a,b){"undefined"==typeof SOTool.CloudSdkPlugin&&(SOTool.CloudSdkPlugin={});SOTool.CloudSdkPlugin.hasOwnProperty("STK")||(SOTool.CloudSdkPlugin.STK={});SOTool.CloudSdkPlugin.STK[a]=b},getObj:function(a){"undefined"==typeof SOTool.CloudSdkPlugin&&(SOTool.CloudSdkPlugin={});if(!SOTool.CloudSdkPlugin.hasOwnProperty("STK"))throw Error("no "+a+" Obj");return SOTool.CloudSdkPlugin.STK[a]},creatPlugin:function(a,
b){"undefined"==typeof SOTool.CloudSdkPlugin&&(SOTool.CloudSdkPlugin={});SOTool.CloudSdkPlugin[a]=b},getPlugin:function(a,b){if("STK"==a)throw Error(a+" is not support");SOTool.CloudSdkPlugin&&"undefined"!=typeof SOTool.CloudSdkPlugin[a]?b&&b(SOTool.CloudSdkPlugin[a]):SOTool.JsList.hasOwnProperty(SOTool.PluginStack[a])?b&&SOTool.JsList[SOTool.PluginStack[a]].push(b):(SOTool.JsList[SOTool.PluginStack[a]]=[],b&&SOTool.JsList[SOTool.PluginStack[a]].push(b),videoSdkTool.getJS(SOTool.PluginStack[a],function(){var b=
videoSdkTool.clone(SOTool.JsList[SOTool.PluginStack[a]]);delete SOTool.JsList[SOTool.PluginStack[a]];for(var c=0;c<b.length;c++){var f=b[c];f&&f(SOTool.CloudSdkPlugin[a])}},function(){var b=videoSdkTool.clone(SOTool.JsList[SOTool.PluginStack[a]]);delete SOTool.JsList[SOTool.PluginStack[a]];for(var c=0;c<b.length;c++){var f=b[c];f&&f(null)}},this,"utf-8"))},setPluginStack:function(a,b){if(videoSdkTool.isArray(a))for(var k=0;k<a.length;k++)arguments.callee(a[k],b);else if(a.hasOwnProperty("name")&&
a.hasOwnProperty("url"))SOTool.PluginStack[a.name]=a.url,"http"!=a.url.substr(0,4)&&(SOTool.PluginStack[a.name]="https:"==SOTool.location.protocol?SOTool.location.protocol+SOTool.PluginStack[a.name].replace(/{domain}/g,"s.yuntv.letv.com"):"http:"+SOTool.PluginStack[a.name].replace(/{domain}/g,"yuntv.letv.com"),SOTool.PluginStack[a.name]=SOTool.PluginStack[a.name].replace(/{LANG}/g,b));else throw Error(a+"must has name and url");},preload:function(){for(var a=arguments,b=0;b<a.length;b++)SOTool.getPlugin(a[b])}};
SOTool.shareObj("common.SOTool",SOTool);
var DomainTool=function(){function a(b,a){var c="";-1!=b.indexOf("://")&&(c=b.split("://")[1]);var g=c;k.hasOwnProperty(c)&&k[c].hasOwnProperty(a)&&(g=k[c][a]);return b.replace(c,g)}function b(b,a){var k=b;if(window&&"https:"==window.location.protocol||"undefined"!=typeof a&&a){if(-1!=b.indexOf("http://"))return k=b.split("://")[1],c.hasOwnProperty(k)&&(k=c[k]),"https://"+k;c.hasOwnProperty(k)&&(k=c[k])}return k}var k={"api.mms.lecloud.com":{en_US:"api.usmms.lecloud.com"},"apple.www.letv.com":{en_US:"apple.us.www.letv.com"}},
c={"yuntv.letv.com":"s.yuntv.letv.com","sdk.lecloud.com":"sdkletv.lecloud.com","ark.letv.com":"arkletv.lecloud.com","api.letvcloud.com":"apiletv.lecloud.com","api.mms.lecloud.com":"api-mms.lecloud.com","api.live.letvcloud.com":"api-live.lecloud.com","apple.www.letv.com":"apple-www.le.com","log.cdn.letvcloud.com":"log-cdn.letvcloud.com"};return{getDomain:function(k,c,e){var g=k;-1!=k.indexOf("://")&&(g=k.match(/^http(|s):\/\/[a-zA-Z\.0-9:]*/)[0],g=k.replace(g,b(a(g,c),e)));return g}}}();
SOTool.shareObj("common.DomainTool",DomainTool);var Message=function(){return{NoSupportPano:0,Drm:1,NoStart:2,INTERRUPT:3,END:4}}();SOTool.shareObj("model.Message",Message);var LangTool=function(){var a=!1,b;return{loadLang:a,toMessage:function(k,c,f){if(a)return b.hasOwnProperty(f)?{message:b[f]}:{message:f};SOTool.getPlugin("lang.message.plugin."+c,function(c){c&&(b=c,a=!0);k()});return!1},ms:b}}();SOTool.shareObj("common.LangTool",LangTool);
var videoSdkTool=function(){function a(k){try{var a=wx.getSystemInfoSync(),f=a.system.split(" ");b.device=a.model.split(" ")[0].toLowerCase();b.os=f[0].toLowerCase();b.osv=f[1].toLowerCase();b.screenWidth=wx.windowWidth;b.screenHeight=wx.windowHeight}catch(d){b.os="un",b.osv="un"}}var b={br:"",device:"",ver:"",params:null,os:"",osv:"",screenWidth:0,screenHeight:0};return{br:b,getUrl:function(){return window?window.location.href:""},getOs:function(){""==b.os&&a("");return b.os},getUrlParams:function(a){null==
b.params&&(b.params={});return b.params&&b.params.hasOwnProperty(a)?b.params[a]:!1},getDevice:function(){""==b.device&&a();return b.device},getOsv:function(){""==b.osv&&a();return b.osv},getScreenWidth:function(){0==b.screenWidth&&a();return b.osv},getScreenHeight:function(){0==b.screenHeight&&a();return b.osv},getBrowser:function(){""==b.br&&(b.br="un");return b.br},getBrowserVersion:function(){""==b.br&&(b.br="un");""==b.ver&&(b.ver="-");return b.br+b.ver},now:Date.now||function(){return+new Date},
getJS:function(b,a,f,d,e,g){},getJSON:function(b,a,f,d,e,g){var h=this.now(),l=0,m=0,n=this,p=-1;this.urlToObj(b);d=d||5E3;var q=e||2,r=g||1E3,t=function(){clearTimeout(m);l>=q?f&&f.call(this,null,{responseTime:n.now()-h,retryCount:l,error:p}):setTimeout(s,r)},s=function(){clearTimeout(m);l++;b=b.replace(/&_r=[\d|\?]+/i,"&_r="+l);wx.request({url:b,data:{},method:"GET",header:{},success:function(b){clearTimeout(m);p=-1;a.call(this,b.data,{responseTime:n.now()-h,retryCount:l})},fail:function(){t()}});
p=1;m=setTimeout(t,d)};s()},getJSONbyAjax:function(b,a,f,d,e,g){videoSdkTool.getJSON(b,a,f,d,e,g)},creatUuid:function(){var b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),a=[],f,d;d=16;for(f=0;32>f;f++)a[f]=b[0|Math.random()*d];return a.join("")},urlToObj:function(b){var a={},f=b;-1!=b.indexOf("?")&&(f=b.substr(1));b=f.split("&");for(f=0;f<b.length;f++){var d=b[f].substr(0,b[f].indexOf("=")),e=b[f].substr(b[f].indexOf("=")+1);a[d]=e}return a},objectParseToString:function(b){if(null==
b)return"";var a="",f=0,d;for(d in b)a=0<f?a+("&"+d+"="+b[d]):a+(d+"="+b[d]),f++;return a},setLocal:function(b,a,f){try{wx.setStorageSync(b,a)}catch(d){}},getLocal:function(b,a){try{wx.getStorageSync(b)}catch(f){}return null},num2Time:function(b){var a;a=10>parseInt(b/60)?"0"+parseInt(b/60)+":":parseInt(b/60)+":";b=10>parseInt(b%60)?"0"+parseInt(b%60)+"":parseInt(b%60)+"";return a+b},clone:function(b){var a,f,d;if("object"!=typeof b||null===b)return b;if(b instanceof Array)for(a=[],f=0,d=b.length;f<
d;f++)a[f]="object"==typeof b[f]&&null!=b[f]?videoSdkTool.clone(b[f]):b[f];else for(f in a={},b)a[f]="object"==typeof b[f]&&null!=b[f]?videoSdkTool.clone(b[f]):b[f];return a},isHttps:function(){try{return"https:"==window.location.protocol}catch(b){}return!1},isArray:function(b){return"[object Array]"===Object.prototype.toString.call(b)},isFunction:function(b){return"[object Function]"===Object.prototype.toString.call(b)},addUrlParams:function(b,a){for(var f=0;f<b.length;f++){var d=b[f],e;for(e in a)-1==
d.indexOf("&"+e+"=")&&-1==d.indexOf("?"+e+"=")&&(d=-1!=d.indexOf("?")?d+("&"+e+"="+a[e]):d+("?"+e+"="+a[e]));b[f]=d}},bindFun:function(b,a){return b.bind?b.bind(a):function(){return b.apply(a,arguments)}},split:function(b,a,f){b=b.split(a);var d=[];if("undefined"==typeof f||f>=b.length)return b;for(;d.length<f-1;)d.push(b[0]),b.shift();d[f-1]=b.join(a);return d}}}();SOTool.shareObj("common.videoSdkTool",videoSdkTool);
videoSdkTool.checkPano=function(){try{var a=document.createElement("canvas");if(window.WebGLRenderingContext&&(a.getContext("webgl")||a.getContext("experimental-webgl")))switch(videoSdkTool.getDevice()){case "androidPad":case "androidPhone":case "android":if("chrome"==videoSdkTool.getBrowser()||"firefox"==videoSdkTool.getBrowser())return!0;break;case "pc":return!0}}catch(b){}return!1};SOTool.shareObj("common.videoSdkTool",videoSdkTool);
var BaseCode={decode:function(a){var b,k,c,f,d,e=0,g=0;f="";var h=[];if(!a)return a;a+="";do b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(e++)),k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(e++)),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(e++)),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(e++)),c=b<<18|k<<12|f<<6|d,b=c>>16&255,k=c>>
8&255,c&=255,64==f?h[g++]=String.fromCharCode(b):64==d?h[g++]=String.fromCharCode(b,k):h[g++]=String.fromCharCode(b,k,c);while(e<a.length);return f=h.join("")},encode:function(a){var b,k,c,f,d=0,e=0,g="",g=[];if(!a)return a;a=this.utf8_encode(a+"");do b=a.charCodeAt(d++),k=a.charCodeAt(d++),c=a.charCodeAt(d++),f=b<<16|k<<8|c,b=f>>18&63,k=f>>12&63,c=f>>6&63,f&=63,g[e++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(k)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f);while(d<a.length);g=g.join("");switch(a.length%3){case 1:g=g.slice(0,-2)+"==";break;case 2:g=g.slice(0,-1)+"="}return g},utf8to16:function(a){var b,k,c,f,d,e;b="";c=a.length;for(k=0;k<c;)switch(f=a.charCodeAt(k++),f>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:b+=a.charAt(k-1);break;case 12:case 13:d=a.charCodeAt(k++);b+=String.fromCharCode((f&
31)<<6|d&63);break;case 14:d=a.charCodeAt(k++),e=a.charCodeAt(k++),b+=String.fromCharCode((f&15)<<12|(d&63)<<6|(e&63)<<0)}return b}},MD5=function(){function a(b,a,k,c,l,m){b=f(f(a,b),f(c,m));return f(b<<l|b>>>32-l,k)}function b(b,k,c,f,l,m,n){return a(k&c|~k&f,b,k,l,m,n)}function k(b,k,c,f,l,m,n){return a(k&f|c&~f,b,k,l,m,n)}function c(b,k,c,f,l,m,n){return a(c^(k|~f),b,k,l,m,n)}function f(b,a){var k=(b&65535)+(a&65535);return(b>>16)+(a>>16)+(k>>16)<<16|k&65535}return{hash:function(d){for(var e=[],
g=0;g<8*d.length;g+=8)e[g>>5]|=(d.charCodeAt(g/8)&255)<<g%32;d=8*d.length;e[d>>5]|=128<<d%32;e[(d+64>>>9<<4)+14]=d;d=1732584193;for(var g=-271733879,h=-1732584194,l=271733878,m=0;m<e.length;m+=16){var n=d,p=g,q=h,r=l;d=b(d,g,h,l,e[m+0],7,-680876936);l=b(l,d,g,h,e[m+1],12,-389564586);h=b(h,l,d,g,e[m+2],17,606105819);g=b(g,h,l,d,e[m+3],22,-1044525330);d=b(d,g,h,l,e[m+4],7,-176418897);l=b(l,d,g,h,e[m+5],12,1200080426);h=b(h,l,d,g,e[m+6],17,-1473231341);g=b(g,h,l,d,e[m+7],22,-45705983);d=b(d,g,h,l,e[m+
8],7,1770035416);l=b(l,d,g,h,e[m+9],12,-1958414417);h=b(h,l,d,g,e[m+10],17,-42063);g=b(g,h,l,d,e[m+11],22,-1990404162);d=b(d,g,h,l,e[m+12],7,1804603682);l=b(l,d,g,h,e[m+13],12,-40341101);h=b(h,l,d,g,e[m+14],17,-1502002290);g=b(g,h,l,d,e[m+15],22,1236535329);d=k(d,g,h,l,e[m+1],5,-165796510);l=k(l,d,g,h,e[m+6],9,-1069501632);h=k(h,l,d,g,e[m+11],14,643717713);g=k(g,h,l,d,e[m+0],20,-373897302);d=k(d,g,h,l,e[m+5],5,-701558691);l=k(l,d,g,h,e[m+10],9,38016083);h=k(h,l,d,g,e[m+15],14,-660478335);g=k(g,h,
l,d,e[m+4],20,-405537848);d=k(d,g,h,l,e[m+9],5,568446438);l=k(l,d,g,h,e[m+14],9,-1019803690);h=k(h,l,d,g,e[m+3],14,-187363961);g=k(g,h,l,d,e[m+8],20,1163531501);d=k(d,g,h,l,e[m+13],5,-1444681467);l=k(l,d,g,h,e[m+2],9,-51403784);h=k(h,l,d,g,e[m+7],14,1735328473);g=k(g,h,l,d,e[m+12],20,-1926607734);d=a(g^h^l,d,g,e[m+5],4,-378558);l=a(d^g^h,l,d,e[m+8],11,-2022574463);h=a(l^d^g,h,l,e[m+11],16,1839030562);g=a(h^l^d,g,h,e[m+14],23,-35309556);d=a(g^h^l,d,g,e[m+1],4,-1530992060);l=a(d^g^h,l,d,e[m+4],11,1272893353);
h=a(l^d^g,h,l,e[m+7],16,-155497632);g=a(h^l^d,g,h,e[m+10],23,-1094730640);d=a(g^h^l,d,g,e[m+13],4,681279174);l=a(d^g^h,l,d,e[m+0],11,-358537222);h=a(l^d^g,h,l,e[m+3],16,-722521979);g=a(h^l^d,g,h,e[m+6],23,76029189);d=a(g^h^l,d,g,e[m+9],4,-640364487);l=a(d^g^h,l,d,e[m+12],11,-421815835);h=a(l^d^g,h,l,e[m+15],16,530742520);g=a(h^l^d,g,h,e[m+2],23,-995338651);d=c(d,g,h,l,e[m+0],6,-198630844);l=c(l,d,g,h,e[m+7],10,1126891415);h=c(h,l,d,g,e[m+14],15,-1416354905);g=c(g,h,l,d,e[m+5],21,-57434055);d=c(d,
g,h,l,e[m+12],6,1700485571);l=c(l,d,g,h,e[m+3],10,-1894986606);h=c(h,l,d,g,e[m+10],15,-1051523);g=c(g,h,l,d,e[m+1],21,-2054922799);d=c(d,g,h,l,e[m+8],6,1873313359);l=c(l,d,g,h,e[m+15],10,-30611744);h=c(h,l,d,g,e[m+6],15,-1560198380);g=c(g,h,l,d,e[m+13],21,1309151649);d=c(d,g,h,l,e[m+4],6,-145523070);l=c(l,d,g,h,e[m+11],10,-1120210379);h=c(h,l,d,g,e[m+2],15,718787259);g=c(g,h,l,d,e[m+9],21,-343485551);d=f(d,n);g=f(g,p);h=f(h,q);l=f(l,r)}e=[d,g,h,l];d="";for(g=0;g<4*e.length;g++)d+="0123456789abcdef".charAt(e[g>>
2]>>g%4*8+4&15)+"0123456789abcdef".charAt(e[g>>2]>>g%4*8&15);return d}}}(),jsonTool={isString:function(a){return"string"===typeof a},stringToJson:function(a){if(this.isString(a))try{return JSON.parse(a)}catch(b){return{}}else return a},isJson:function(a){return a&&"object"===typeof a&&"Object"===a.constructor?!0:!1},jsonToString:function(a){var b="";try{b=JSON.stringify(a)}catch(k){b=k}return b}},logTool=function(){var a=[];return{log:function(b,k,c){k="undefined"!=typeof k?"["+k.constructor.name+
"]":"-";c="undefined"!=typeof c?c:"-";if(""!=b)try{var f=new Date,d="["+f.getFullYear()+"-"+f.getMonth()+"-"+f.getDate()+" "+f.getHours()+":"+f.getMinutes()+":"+f.getSeconds()+":"+f.getMilliseconds()+"]";a.push(d+b+"  target--\x3e"+k);1E3<a.length&&a.shift();getApp().globalData.DebugBCLV&&console.log(b,k,c,d)}catch(e){}},getLog:function(b){return a.join("<br>\r\n")}}}(),ReportTool=function(){return{print:function(a,b){},report:function(a,b){}}}(),ClassTool=function(){var a={};return{inherits:function(b,
a){function c(){}try{c.prototype=a.prototype,b.prototype=new c,b.prototype.constructor=b,b.prototype.superClass=a.prototype}catch(f){debugger}},provideClass:function(b,a){var c=b.split(".");if(1<c.length)for(var f=0;f<c.length-1;f++){var d=c[f];last.hasOwnProperty(d)||(last[d]={});last=last[d]}last[c[c.length-1]]=a},importClass:function(b){for(var k=b.split("."),c=a,f=0;f<k.length-1;f++){var d=k[f];if(!c.hasOwnProperty(d))throw"the "+b+"--"+d+" class is not provide";c=c[d]}return c}}}();
SOTool.shareObj("common.ClassTool",ClassTool);
var GlobalHandler=function(){var a="cid pid vid mmsid pic title url nextvid nextpic nexttitle nexturl nextchapter duration total percent rotation fullscreen color volume jump continuePlay gpu gpuing definition defaultDefinition trylook fullScale originalScale originalRect videoWidth videoHeight".split(" "),b={57:"180",58:"180",1:"350",21:"350",9:"350",161:"350",16:"1000",13:"1000",162:"1000",17:"1300",22:"1300",163:"1300",27:"yuanhua",28:"yuanhua",18:"720p",51:"720p",35:"1080p",52:"1080p",20:"1080p",
36:"1080p",54:"k4"};return{defList:"180 350 1000 1300 yuanhua 720p 1080p k4".split(" "),settingList:function(){return a},checkPlayType:function(){return"ios"},def2Type:function(b,a){return a.hasOwnProperty(b)?a[b]:b},type2Def:function(a){return b.hasOwnProperty(a)?b[a]:a},initTypeDefObj:function(a,c){for(var f=0;f<a.length;f++){var d=a[f];b.hasOwnProperty(d)&&(c[b[d]]=d)}}}}(),LiveGlobalHandler=function(){var a="liveId sid mmsid pic title url nextvid nextpic nexttitle nexturl nextchapter duration total percent rotation fullscreen color volume jump continuePlay gpu gpuing definition defaultDefinition trylook fullScale originalScale originalRect videoWidth videoHeight".split(" "),
b={10:"180",13:"350",16:"1000",19:"1300",99:"yuanhua",22:"720p",25:"1080p",28:"k4"};return{defList:"180 350 1000 1300 yuanhua 720p 1080p k4".split(" "),settingList:function(){return a},liveInfoMap:{0:Message.NoStart,2:Message.INTERRUPT,3:Message.END},def2Type:function(b,a){return a.hasOwnProperty(b)?a[b]:b},type2Def:function(a){return b.hasOwnProperty(a)?b[a]:a},initTypeDefObj:function(a,c){for(var f=0;f<a.length;f++){var d=a[f];b.hasOwnProperty(d)&&(c[b[d]]=d)}}}}(),PlayState={PLAY:0,PAUSE:1,STOP:2},
ERR={PARAMS:"1",NOSTART:"2",INTERRUPT:"3",END:"7",NOPLAN:"4",PEOPLE_OUT:"5",WHITE_LIST:"6",ACTIVITY_IO:"60",ACTIVITY_TIMEOUT:"61",ACTIVITY_ANALY:"63",NOSTREAM:"64",LIVE_ANALY:"50",LIVE_IO:"51",LIVE_TIMEOUT:"53",PLAY_IO:"480",PLAY_TIMEOUT:"481",VOD_CONFIG_IO:"150",VOD_CONFIG_TIMEOUT:"152",VOD_MMSID_ANALY:"153",VOD_CONFIG_DRM:"154",GSLB_IO:"470",GSLB_ANALY:"473",NOSupport:"490"};
SOTool.shareObj("manager.ColorManager",function(){function a(){this.managerDsipayList=[];this.cList=[];this.colorConfig={bgColor:"#000000",fault:"#aaaaaa",active:"#208ac3"}}var b=SOTool.getObj("common.UiTool");a.prototype.setColor=function(a,c,f,d){"undefined"==typeof f&&(f="bg");"undefined"==typeof d&&(d=1);a.setColor(b.hexToRgba(this.colorConfig[c],d),f);var e=this.managerDsipayList.indexOf(a);-1==e?(this.managerDsipayList.push(a),this.cList.push({display:a,key:c,type:f,alpha:d})):(this.cList[e].key=
c,this.cList[e].type=f,this.cList[e].alpha=d)};a.prototype.register=function(b){for(var a in b)this.colorConfig.hasOwnProperty(a)&&("0x"==b[a].substr(0,2)&&(b[a]=b[a].substr(2)),"#"!=b[a].substr(0,1)?this.colorConfig[a]="#"+b[a]:this.colorConfig[a]=b[a])};a.prototype.refresh=function(a){this.register(a);for(a=0;a<this.cList.length;a++)this.cList[a].display.setColor(b.hexToRgba(this.colorConfig[this.cList[a].key],this.cList[a].alpha),this.cList[a].type)};return a}());
var ClassObject=function(){function a(){this.init()}a.prototype={init:function(){},addEventListener:function(b,a,c,f){if("undefined"==typeof b)throw this.log(b),Error("type is undefined");if("undefined"==typeof a)throw this.log(a),Error("handler is undefined");"undefined"==typeof c&&(c=this);this.hasOwnProperty("EventMap")||(this.EventMap={});this.EventMap.hasOwnProperty(b)||(this.EventMap[b]=[]);this.hasEventListener(b,a,c)||this.EventMap[b].push({fun:a,target:c})},hasEventListener:function(b,a,
c){if("undefined"==typeof b)throw this.log(b),Error("type is undefined");if("undefined"==typeof a)throw this.log(a),Error("handler is undefined");if("undefined"==typeof c)throw this.log(c),Error("handlerThis is undefined");if(this.hasOwnProperty("EventMap")&&this.EventMap.hasOwnProperty(b))for(var f=0;f<this.EventMap[b].length;f++){var d=this.EventMap[b][f];if(d.fun==a&&d.target==c)return!0}return!1},dispatchEvent:function(b){var a=b.type;b.target=this;this.hasOwnProperty("EventMap")||(this.EventMap=
{});if(this.EventMap.hasOwnProperty(a)){for(var c=[],f=0;f<this.EventMap[a].length;f++)c.push(this.EventMap[a][f]);for(f=0;f<c.length;f++)c[f].fun.call(this.EventMap[a][f].target,b)}},removeEventListener:function(b,a,c){this.hasOwnProperty("EventMap")||(this.EventMap={});if(this.EventMap.hasOwnProperty(b))for(var f=0;f<this.EventMap[b].length;f++)if(this.EventMap[b][f].fun==a&&this.EventMap[b][f].target==c){this.EventMap[b].splice(f,1);0==this.EventMap[b].length&&delete this.EventMap[b];break}},destroy:function(){for(var b in this.EventMap)delete this.EventMap[b];
this.EventMap=null},log:function(b){logTool.log(b,this)}};return a}();SOTool.shareObj("core.ClassObject",ClassObject);var Control=function(){function a(b,a){this.init(b,a)}ClassTool.inherits(a,ClassObject);a.prototype.init=function(b,a){this.facade=b;this.model=a};return a}(),Event=function(){return function(){this.type=arguments[0];this.args=arguments}}();SOTool.shareObj("core.Event",Event);
var Facade=function(){function a(){}var b=SOTool.getObj("manager.ColorManager");ClassTool.inherits(a,SOTool.getObj("core.ClassObject"));a.prototype.init=function(a){this.color=new b;this.color.register(a)};return a}();SOTool.shareObj("core.Facade",Facade);
var Proxy=function(){function a(){}ClassTool.inherits(a,ClassObject);a.prototype.load=function(b){this.loader=new AutoLoader;this.isClose=!1;b=this.getRequestList();2==this.requestType?this.loader.load2(b,this.loadCmp,this.loadError,this):this.loader.load(b,this.loadCmp,this.loadError,this)};a.prototype.getUrl=function(b){return 1<this.loader.urlList.length?this.loader.urlList[0].url:""};a.prototype.getRequestList=function(b){return[]};a.prototype.unload=function(b){this.loader&&this.loader.destroy();
this.isClose=!0};a.prototype.loadCmp=function(b,a){!this.isClose&&this.dispatchEvent(new Event(LoadEvent.LOADCMP,[b,a]))};a.prototype.loadError=function(b,a){!this.isClose&&this.dispatchEvent(new Event(LoadEvent.LOADERROR,[b,a]))};return a}(),Plugin=function(){function a(){}ClassTool.inherits(a,ClassObject);a.prototype.initPlugin=function(b,a,c){this.pluginCmpFun=a;this.REConf=c;if(this.REConf.hasOwnProperty(b.type))if(a=this.REConf[b.type],a.hasOwnProperty("check"))if("function"==typeof a.check)if(a.check())this.load(b);
else b.onerror(a.err);else if(a.check)this.load(b);else b.onerror(a.err);else this.load(b);else this.pluginCmpFun(null),b.onstart()};a.prototype.load=function(b){var a=this;a.pl=this.REConf[b.type];SOTool.getPlugin(a.pl.name,function(c){if(c)a.pluginCmpFun(c);else b.onerror({code:420,message:"\u63d2\u4ef6\u52a0\u8f7d\u9519\u8bef"})})};return a}(),View=function(){function a(b,a){this.facade=b;this.model=a;this.init()}ClassTool.inherits(a,ClassObject);a.prototype.init=function(){this.tplKey="view";
this.addEvent=!0};a.prototype.setUp=function(b,a,c){"undefined"==typeof c&&(c="");c=SkinRender.SkinTpl[this.tplKey]||c;this.el=UiTool.$E(b);this.skin=new DisplayObject(this.el);b=UiTool.getTemplate(this.el,c);if(a)for(a=0;a<b.length;a++)this.el[b[a]]=new DisplayObject(this.el[b[a]]);this.addEvent&&this.facade.addEventListener(SkinEvent.EVENT,this.skinHandler,this)};a.prototype.skinHandler=function(b){};a.prototype.setSize=function(b,a){};a.prototype.show=function(){this.skin.setVisible(!0)};a.prototype.hide=
function(){this.skin.setVisible(!1)};return a}();SOTool.shareObj("core.View",View);
var AutoLoader=function(){function a(){}a.prototype={load:function(b,a,c,f){this.urlList=b;var d=this,e=0,g=videoSdkTool.now(),h=function(){clearTimeout(d.delayID);var b=d.getRealUrl(d.urlList[0]);d.log("load url:"+b);videoSdkTool.getJSON(b,function(b,c){e+=c.retryCount;a&&a.call(f,b,{responseTime:videoSdkTool.now()-g,retryCount:e})},function(b,a){1<d.urlList.length?(e+=d.urlList[0].maxCount,d.urlList.shift(),d.delayID=setTimeout(h,d.urlList[0].retryTime)):(e+=a.retryCount,c&&c.call(f,null,{responseTime:videoSdkTool.now()-
g,retryCount:e}))},d.urlList[0].timeout,d.urlList[0].maxCount,d.urlList[0].retryTime)};h()},load2:function(b,a,c,f){this.urlList=b;var d=this,e=0,g=videoSdkTool.now(),h=function(){clearTimeout(d.delayID);var b=d.getRealUrl(d.urlList[0]);d.log("load url:"+b);videoSdkTool.getJSONbyAjax(b,function(b,c){e+=c.retryCount;a&&a.call(f,b,{responseTime:videoSdkTool.now()-g,retryCount:e})},function(b,a){1<d.urlList.length?(e+=d.urlList[0].maxCount,d.urlList.shift(),d.delayID=setTimeout(h,d.urlList[0].retryTime)):
(e+=a.retryCount,c&&c.call(f,null,{responseTime:videoSdkTool.now()-g,retryCount:e}))},d.urlList[0].timeout,d.urlList[0].maxCount,d.urlList[0].retryTime)};h()},getRealUrl:function(b){return videoSdkTool.isFunction(b.url)?b.hasOwnProperty("args")?b.url(b.args):b.url():b.url},destroy:function(){clearTimeout(this.delayID)},log:function(b){logTool.log(b,this)}};return a}(),Timer=function(){function a(b,a,c,f){this.delay=b;this.timerHandler=c;this.handlerThis=a;"undefined"==typeof f&&(f=0);this.max=f;this.currentCount=
this.T=0;this.running=!0}a.prototype={start:function(){this.running=!0;this.checkTime(!1)},checkTime:function(b){var a=this;clearTimeout(this.T);if(b&&(a.currentCount++,a.timerHandler.call(a.handlerThis),0<a.max&&a.currentCount>=a.max)){a.stop();return}a.T=setTimeout(function(){a.checkTime.call(a,!0)},a.delay)},stop:function(){this.running=!1;clearTimeout(this.T)},reset:function(){this.stop();this.currentCount=0},clear:function(){this.handlerThis=this.timerHandler=this.delay=null;this.T=0}};return a}();
SOTool.shareObj("core.util.Timer",Timer);
var SkinRender={SkinTpl:"",setPlayerCss:function(a){""!=a&&(a="."+a+" ");a="{id} img{width: auto !important;height: auto !important;}".replace(/{id}/g,a);UiTool.loadCss(a)},setMediacontrols:function(a,b){var k;""!=a&&(a="."+a+" ");k="{id}video::-webkit-media-controls-enclosure,{id}video::-webkit-media-controls {display: {dislay} !important;}".replace(/{id}/g,a);k=b?k.replace("{dislay}",""):k.replace("{dislay}","none");UiTool.loadCss(k)},setMediafullscreen:function(a,b){var k;""!=a&&(a="."+a+" ");
k="{id}video::-webkit-media-controls-fullscreen-button {display: {dislay} !important;}".replace(/{id}/g,a);k=b?k.replace("{dislay}",""):k.replace("{dislay}","none");UiTool.loadCss(k)},getSkinTpl:function(a,b,k,c){if(""==SkinRender.SkinTpl){"undefined"==typeof window.CloudSdkPlugin&&(window.CloudSdkPlugin={});window.CloudSdkPlugin.skinUuid=videoSdkTool.creatUuid();var f=window.CloudSdkPlugin.skinUuid;b=b.replace(/{#BGP}/g,k);b=b.replace(/{#}/g,f);UiTool.loadCss(b);for(var d in a)for(a[d]=a[d].replace(/{#}/g,
f),b=a[d].match(/{[a-z_A-Z0-9]{1,}\.[a-z_A-Z0-9]{1,}}/g)||[],k=0;k<b.length;k++){var e=b[k].replace(/{|}/g,"").split("."),g=e[0],e=e[1];c&&c.hasOwnProperty(g)&&c[g].hasOwnProperty(e)&&(g=[g,c[g][e].width,c[g][e].height,c[g][e].src].join(";"),a[d]=a[d].replace(b[k],g))}SkinRender.SkinTpl=a}}};SOTool.shareObj("core.SkinRender",SkinRender);var AdEvent=function(){return{EVENT:"adEvent",HEADSTART:"adHeadPlayStart",HEADEND:"adHeadPlayComplete",NOAD:"adHeadPlayNone"}}();SOTool.shareObj("event.AdEvent",AdEvent);
var LoadEvent=function(){return{LOADCMP:"loadcmp",LOADERROR:"loaderror"}}();SOTool.shareObj("event.LoadEvent",LoadEvent);
var PlayerEvent=function(){return{EVENT:"playerEvent",INIT:"playerInit",VIDEO_AUTH_VALID:"videoAuthValid",VIDEO_DATA_START:"videoDataStart",VIDEO_DATA_CMP:"videoDataCmp",GSLB_START:"gslbStart",GSLB_CMP:"gslbCmp",VPH:"videoPageHide",VPS:"videoPageShow",WPH:"webPageHide",ERROR:"playerError",RESIZE:"playerResize",VIDEO_INFO:"videoInfo",FULLSCREEN:"fullscreen",PRESIZE:"resize",VIDEO_LIVESTOP:"videoLiveStop",VIDEO_INTERRUPT:"videoLiveInterupt",USER_INFO:"user_info"}}();
SOTool.shareObj("event.PlayerEvent",PlayerEvent);var MediaEvent=function(){return{EVENT:"MediaEvent",CONNECT:"videoConnect",START:"videoStart",PLAY:"videoResume",STOP:"videoStop",PAUSE:"videoPause",BUFFEREMPTY:"videoEmpty",BUFFEREFULL:"videoFull",SEEK:"videoSeek",SEEKEMPTY:"videoSeekEmpty",PLAYING:"videoPlaying",LODING:"videoLoading",METADATA:"MetaData",DURATION:"videoDuration",DEFSTART:"swapDefinition",ERROR:"videoError",VOL:"vol",REPLAY:"videoReplay"}}();SOTool.shareObj("event.MediaEvent",MediaEvent);
var SkinEvent=function(){return{EVENT:"skinEvent",PLAY:"skinPlay",PAUSE:"skinPause",SETDEFINITION:"setDefinition",SEEK:"skinSeek",VOLUME:"skinVolume",FULLSCREEN:"skinFullScreen",REPLAY:"skinReplay"}}();SOTool.shareObj("event.SkinEvent",SkinEvent);
var Model=function(){function a(){for(var b="mac nt os osv app bd xh ro cs ssid lo la".split(" "),a=this,c=0;c<b.length;c++)this[b[c]]="";this.refresh=function(b){for(var c in b)a[c]=b[c]}}function b(){var b=this;this.autoplay=0;this.refresh=function(a){for(var c in a)b[c]=a[c]}}function k(){var b=this;this.refresh=function(a){for(var c in a)b[c]=a[c]}}function c(){for(var b=["userId"],a=this,c=0;c<b.length;c++)this[b[c]]="";this.refresh=function(b){for(var c in b)a[c]=b[c]}}function f(){for(var b=
"title duration volume definition defaultDefinition fullscreen percent time url videoWidth videoHeight".split(" "),a=this,c=0;c<b.length;c++)this[b[c]]="";this.definitionCount=0;this.refresh=function(b){for(var c in b)a[c]=b[c]}}function d(){this.systemData=new a;this.config=new b;this.reportParam={};this.clear()}d.prototype={init:function(b){this.systemData.refresh(b);this._apprunid=this.lc()+"_"+videoSdkTool.now()},clear:function(){this._uuid="";this._lc=videoSdkTool.getLocal("lc");this.userData=
new c;this.videoSetting=new f;this.playerConfig=new k},uuid:function(){""==this._uuid&&(this._uuid=videoSdkTool.creatUuid());return this._uuid+"_"+this.videoSetting.definitionCount},clearUuid:function(){this._uuid=""},lc:function(){null==this._lc&&(this._lc=videoSdkTool.creatUuid(),videoSdkTool.setLocal("lc",this._lc));return this._lc},getTypeFrom:function(){var b=videoSdkTool.getUrlParams("ch");if(b)return b.toString();try{if(""!=this.userInfo().userId)return"bcloud_"+this.userInfo().userId}catch(a){}return"letv"},
apprunid:function(){return this._apprunid},auid:function(){return this.systemData.deviceId},pcode:function(){return"-"},videoInfo:function(){var b=this.api.getVideoInfo();this.videoSetting.refresh(b);return b},userInfo:function(){return this.userData}};return d}(),UrlProxy=function(){function a(b){this.model=b;this.model.defaultDefinitionList=[]}ClassTool.inherits(a,Proxy);a.prototype.load=function(b){var a=this.model;a.playerConfig.refresh({mloadingUrl:"",logo:{pic:""}});var c={ark:0,gslb:!1},f=
{350:{}};f["350"].vtype="350";f["350"].definition="\u539f\u753b";f["350"].urls=[a.config.url];c.isdrm=0;a.defaultDefinitionList.push("350");c.media=f;a.videoSetting.refresh(c);this.dispatchEvent(new Event(LoadEvent.LOADCMP,[b]))};a.prototype.reload=function(){this.unload();this.superClass.load.call(this)};return a}(),CloudVodProxy=function(){function a(b){this.model=b;this.model.defaultDefinitionList=[]}var b=MD5.hash("gpc_pet"),k=MD5.hash("gpc_playerInfo");ClassTool.inherits(a,Proxy);a.prototype.load=
function(b){this.curTime=0;this.superClass.load.call(this,b)};a.prototype.getRequestList=function(){for(var a=[],k=["//106.39.244.239/","//111.206.211.221/","//223.95.79.18/"],d={cf:this.getCf(),ran:this.getCurTime(),pver:this.model.playerConfig.version,bver:encodeURIComponent(videoSdkTool.getBrowserVersion()),uuid:this.model.uuid(),pf:"html5",spf:this.getSpf()},e="https://apiletv.lecloud.com/gpc.php?format=json&ver=2.4",g="ark uu vu payer_name check_code pu lang cuid utoken".split(" "),h=0;h<g.length;h++){var l=
g[h];this.model.config.hasOwnProperty(l)&&(d[l]=this.model.config[l])}d.pet=Math.max(0,videoSdkTool.getLocal(b,!1)+0);d.sign=this.getSign([d.cf,d.uu,d.vu,d.ran]);for(l in d)e+="&"+l+"="+d[l];e+="&page_url="+encodeURIComponent(videoSdkTool.getUrl());a.push({url:e,timeout:5E3,maxCount:3,retryTime:0});for(h=0;h<k.length;h++)-1!=a[0].url.indexOf("//api.letvcloud.com/")&&(d=e.replace("//api.letvcloud.com/",k[h]),a.push({url:d,timeout:5E3,maxCount:3,retryTime:0}));return a};a.prototype.getSign=function(b){return MD5.hash(b.join("")+
"fbeh5player12c43eccf2bec3300344")};a.prototype.getCurTime=function(b){return 0!=this.curTime?this.curTime:parseInt(0.001*videoSdkTool.now())};a.prototype.getCf=function(){switch(videoSdkTool.getDevice()){case "ipad":case "iphone":return"html5_ios"}return"html5"};a.prototype.getSpf=function(){var b=videoSdkTool.getDevice(),a={androidPhone:0,iphone:1,letvTv:2,ipad:3,androidPad:4};return a.hasOwnProperty(b)?a[b]:0};a.prototype.loadCmp=function(a,f){if(!this.isClose){var d=this.model;this.log("gpc ok data:"+
jsonTool.jsonToString(a)+"----time:"+jsonTool.jsonToString(f));if(0==a.code){a=a.data;var e={};e.userId=a.userinfo.userid;d.userData.refresh(e);e={};videoSdkTool.getLocal(b,!1)!=a.playerinfo.pet&&a.playerinfo.hasOwnProperty("logo")?videoSdkTool.setLocal(k,jsonTool.jsonToString(a.playerinfo),!1):(e=jsonTool.stringToJson(videoSdkTool.getLocal(k)),a.playerinfo=e);var g={buttonColor:"fault",progressBarColor:"active"},e={};e.mloadingUrl=a.playerinfo.loadingpic;e.logo=a.playerinfo.logo;e.watermark=a.playerinfo.watermark;
d.playerConfig.refresh(e);!d.outConfig.hasOwnProperty("nskin")&&a.playerinfo.hasOwnProperty("nskin")&&(d.config.nskin=a.playerinfo.nskin);for(var h in a.playerinfo.onoff)g.hasOwnProperty(h)&&(a.playerinfo.onoff[g[h]]=a.playerinfo.onoff[h],delete a.playerinfo.onoff[h],h=g[h]),d.outConfig.hasOwnProperty(h)||(d.config.hasOwnProperty(h)?"boolean"==typeof d.config[h]&&(d.config[h]="1"==a.playerinfo.onoff[h]):d.config[h]=a.playerinfo.onoff[h]);"zh_CN"!=d.config.lang&&(d.config.nskin=7,d.config.share=!1);
e={};e.pic=a.videoinfo.pic;e.vid=a.videoinfo.vid;e.cid=a.videoinfo.cid;e.pid=a.videoinfo.pid;e.title=a.videoinfo.name;e.duration=a.videoinfo.duration;e.defaultDefinition=a.videoinfo.medialist[0].vtype;e.isdrm=a.videoinfo.isdrm;e.ark=a.videoinfo.ark;e.mmsid=a.videoinfo.mmsid;e.pano=a.videoinfo.pa;a.videoinfo.hasOwnProperty("businessline")&&(e.p=a.videoinfo.businessline);for(var g={},l=0;l<a.videoinfo.medialist.length;l++){var m=a.videoinfo.medialist[l];h=m.vtype;g[h]={};g[h].urls=[];for(var n=0;n<
m.urllist.length;n++)g[h].urls.push(this.checkGslbUrl(BaseCode.decode(m.urllist[n].url)));g[h].videoWidth=m.vwidth;g[h].videoHeight=m.vheight;g[h].gbr=m.gbr;g[h].vtype=m.vtype;g[h].definition=m.definition;g[h].videoType=m.urllist[0].videotype;d.defaultDefinitionList.push(h)}e.media=g;videoSdkTool.setLocal(b,a.playerinfo.pet,!1);d.videoSetting.refresh(e);this.dispatchEvent(new Event(LoadEvent.LOADCMP,[a,f]))}else"10071"==a.code?(this.curTime=a.timestamp,this.reload()):this.dispatchEvent(new Event(LoadEvent.LOADERROR,
[{code:ERR.VOD_MMSID_ANALY,message:a.message},f]))}};a.prototype.reload=function(){this.unload();this.superClass.load.call(this)};a.prototype.checkGslbUrl=function(b){switch(videoSdkTool.getDevice()){case "ipad":case "iphone":-1==b.indexOf("&tss=ios&")&&(b=-1!=b.indexOf("&tss=no&")?b.replace("&tss=no&","&tss=ios&"):b+"&tss=ios")}return b};a.prototype.loadError=function(b,a){this.isClose||this.dispatchEvent(new Event(LoadEvent.LOADERROR,[{code:ERR.VOD_CONFIG_IO,errInfo:"url:"+this.getUrl()},a]))};
return a}(),CloudMmsProxy=function(){function a(b){this.model=b;this.model.defaultDefinitionList=[]}var b=MD5.hash("mms_pet"),k=MD5.hash("mms_playerInfo");ClassTool.inherits(a,Proxy);a.prototype.getRequestList=function(){for(var a=[],k=[],d=DomainTool.getDomain("http://api.mms.lecloud.com/v2/mms/play",this.model.config.lang),e="cf uu vu format callback pageurl pver ran ver p pu pet userId utoken".split(" "),g={},h=0;h<e.length;h++){var l=e[h];this.model.config.hasOwnProperty(l)&&(g[l]=this.model.config[l])}g.cf=
this.getCf();g.p=this.model.config.p;g.format="jsonp";g.pver=this.model.playerConfig.version;g.ran=this.getCurTime();g.pet=Math.max(0,videoSdkTool.getLocal(b,!1)+0);g.ver="1.0";a.push({url:videoSdkTool.bindFun(function(b){g.callback="vbk"+videoSdkTool.now()+Math.floor(100*Math.random());var a=d,a=a+("?cf="+g.cf),c;for(c in g)"cf"!=c&&(a+="&"+c+"="+encodeURIComponent(g[c]));g.pageurl=videoSdkTool.getUrl();c=this.getSign(g);a+="&sign="+c+"&pageurl="+encodeURIComponent(g.pageurl);"undefined"!=typeof b&&
(a=a.replace("//api.mms.lecloud.com/",b));return a},this),timeout:5E3,maxCount:3,retryTime:0});for(h=0;h<k.length;h++)a.push({url:a[0].url,timeout:5E3,maxCount:3,retryTime:0,args:k[h]});return a};a.prototype.getSign=function(b){var a=[],d;for(d in b)a.push(d);a.sort();d="";for(var k=0;k<a.length;k++)d+=b[a[k]];return MD5.hash(d+"04c5e1e616f668bc559af2afa98b9a25")};a.prototype.getCf=function(){switch(videoSdkTool.getDevice()){case "ipad":return"h5-ipad";case "iphone":return"h5-ios";case "androidPad":return"h5-androidpad";
case "androidPhone":return"h5-android";case "wph":case "pc":return"h5-win";case "mac":return"h5-mac"}return this.model.config.hasOwnProperty("cf")?this.model.config.cf:"other"};a.prototype.getSpf=function(){var b=videoSdkTool.getDevice(),a={androidPhone:0,iphone:1,letvTv:2,ipad:3,androidPad:4};return a.hasOwnProperty(b)?a[b]:0};a.prototype.getCurTime=function(b){return this.curTime?this.curTime:parseInt(0.001*videoSdkTool.now())};a.prototype.loadCmp=function(a,f){if(!this.isClose){var d=this.model;
if(0==a.code){a=a.data;var e={};e.userId=a.userinfo.userid;d.userData.refresh(e);videoSdkTool.getLocal(b,!1)!=a.playerinfo.pet&&a.playerinfo.hasOwnProperty("logo")?videoSdkTool.setLocal(k,jsonTool.jsonToString(a.playerinfo),!1):(e=jsonTool.stringToJson(videoSdkTool.getLocal(k)),a.playerinfo=e);e={};e.mloadingUrl=a.playerinfo.loadingpic;e.logo=a.playerinfo.logo;e.watermark=a.playerinfo.watermark;d.playerConfig.refresh(e);var e={buttonColor:"fault",progressBarColor:"active"},g;for(g in a.playerinfo.onoff)e.hasOwnProperty(g)&&
(a.playerinfo.onoff[e[g]]=a.playerinfo.onoff[g],delete a.playerinfo.onoff[g],g=e[g]),d.outConfig.hasOwnProperty(g)||(d.config[g]=a.playerinfo.onoff[g]);"zh_CN"!=d.config.lang&&(d.config.share=!1);d.config.nskin=7;e={};e.vid=a.videoinfo.vid;e.cid=a.videoinfo.cid;e.pid=a.videoinfo.pid;e.title=a.videoinfo.name;e.duration=a.videoinfo.duration;e.defaultDefinition=a.videoinfo.medialist[0].vtype;e.isdrm=a.videoinfo.isdrm;e.ark=a.videoinfo.ark;e.mmsid=a.videoinfo.mmsid;e.pano=a.videoinfo.pa;a.videoinfo.hasOwnProperty("businessline")&&
(e.p=a.videoinfo.businessline);for(var h={},l=0;l<a.videoinfo.medialist.length;l++){var m=a.videoinfo.medialist[l];g=m.vtype;h[g]={};h[g].urls=[];for(var n=0;n<m.urllist.length;n++)h[g].urls.push(m.urllist[n].url);h[g].videoWidth=m.vwidth;h[g].videoHeight=m.vheight;h[g].gbr=m.gbr;h[g].vtype=m.vtype;h[g].definition=m.definition;h[g].videoType=m.urllist[0].videotype;d.defaultDefinitionList.push(g)}e.media=h;e.pic=a.videoinfo.pic["485*303"];d.videoSetting.refresh(e);videoSdkTool.setLocal(b,a.playerinfo.pet,
!1);this.dispatchEvent(new Event(LoadEvent.LOADCMP,[a,f]))}else"10071"==a.code?(this.curTime=a.timestamp,this.reload()):this.dispatchEvent(new Event(LoadEvent.LOADERROR,[{code:ERR.VOD_MMSID_ANALY,message:a.message},f]))}};a.prototype.reload=function(){this.unload();this.superClass.load.call(this)};a.prototype.checkGslbUrl=function(b){switch(videoSdkTool.getDevice()){case "ipad":case "iphone":-1==b.indexOf("&tss=ios&")&&(b=-1!=b.indexOf("&tss=no&")?b.replace("&tss=no&","&tss=ios&"):b+"&tss=ios")}return b};
a.prototype.loadError=function(b,a){this.isClose||this.dispatchEvent(new Event(LoadEvent.LOADERROR,[{code:ERR.VOD_CONFIG_IO},a]))};return a}(),ConfigProxy=function(){function a(b){this.model=b}var b=["//106.39.244.239/","//111.206.211.221/","//223.95.79.18/"];ClassTool.inherits(a,Proxy);a.prototype.getRequestList=function(){for(var a=[],c="http://api.live.letvcloud.com/rtmp/getPlayerConfigeration?ver=v4",f=["activityId"],d=0;d<f.length;d++){var e=f[d];this.model.config.hasOwnProperty(e)?c="domain"==
e?c+("&key="+this.model.config[e]):c+("&"+e+"="+this.model.config[e]):this.model.videoSetting.hasOwnProperty(e)&&(c+="&"+e+"="+this.model.videoSetting[e])}c+="&clientType=4";a.push({url:c,timeout:5E3,maxCount:3,retryTime:0});for(d=0;d<b.length;d++)-1!=a[0].url.indexOf("//api.live.letvcloud.com/")&&(f=c.replace("//api.live.letvcloud.com/",b[d]),a.push({url:f,timeout:5E3,maxCount:3,retryTime:0}));return a};a.prototype.loadCmp=function(b,a){if(!this.isClose){b=BaseCode.decode(b.value);b=jsonTool.stringToJson(b);
this.log("config data"+jsonTool.jsonToString(b)+"----time:"+jsonTool.jsonToString(a));var f=this.model,d={};d.userId=b.customerId;f.userData.refresh(d);d={};d.liveId=b.liveId;for(var e={},g=0;g<b.streams.length;g++){var h=b.streams[g];if(1==h.streamState){e.hasOwnProperty(h.rateType)||(e[h.rateType]={},e[h.rateType].videoWidth=h.width,e[h.rateType].videoHeight=h.height,e[h.rateType].sid=h.streamId,e[h.rateType].definition=h.rateName,e[h.rateType].urls=[]);e[h.rateType].urls.push(h.streamUrl);break}}d.media=
e;f.videoSetting.refresh(d);this.dispatchEvent(new Event(LoadEvent.LOADCMP,[b,a]))}};return a}(),ActiveIdProxy=function(){function a(b){this.model=b}var b=["//106.39.244.239/","//111.206.211.221/","//223.95.79.18/"];ClassTool.inherits(a,Proxy);a.prototype.getRequestList=function(){var a=[],c="https://api-live.lecloud.com/liveVideo/getLvInfoForPlayer?ver=v0.1&keyType=1",f=["activityId","domain","p","customerId"];this.getP();for(var d=0;d<f.length;d++){var e=f[d];this.model.config.hasOwnProperty(e)&&
(c="domain"==e?c+("&key="+this.model.config[e]):"activityId"==e?c+("&lvId="+this.model.config[e]):c+("&"+e+"="+this.model.config[e]))}c+="&cf="+this.getCf();a.push({url:c,timeout:5E3,maxCount:3,retryTime:0});for(d=0;d<b.length;d++)-1!=a[0].url.indexOf("//api.live.letvcloud.com/")&&(f=c.replace("//api.live.letvcloud.com/",b[d]),a.push({url:f,timeout:5E3,maxCount:3,retryTime:0}));return a};a.prototype.getCf=function(){switch(videoSdkTool.getDevice()){case "ipad":return"h5-ipad";case "iphone":return"h5-ios";
case "androidPad":return"h5-androidpad";case "androidPhone":return"h5-android";case "wph":case "pc":return"h5-win";case "mac":return"h5-mac"}return this.model.config.hasOwnProperty("cf")?this.model.config.cf:"other"};a.prototype.getP=function(b){this.model.config.hasOwnProperty("p")||(this.model.config.p=100)};a.prototype.loadCmp=function(b,a){if(!this.isClose){this.log("activeProxy data"+jsonTool.jsonToString(b)+"----time:"+jsonTool.jsonToString(a));var f=this.model,d={};d.activityId=b.lvId;d.title=
b.lvName;d.isdrm=0;d.ark=b.ark;d.hasAd=b.isNeedAd;d.pic=b.coverImgUrl;f.config.hasOwnProperty("customerId")&&f.userData.refresh({userId:f.config.customerId});b.hasOwnProperty("businessline")?d.p=b.businessline:this.model.config.hasOwnProperty("p")&&(d.p=this.model.config.p);"http"!=d.pic.substr(0,4)&&(d.pic="");for(;0<b.lives.length;){d.liveId=b.lives[0].liveId;break}f.playerConfig.refresh({mloadingUrl:"",loadingUrl:"",logo:{pic:"",pos:"",url:""}});var e=1;b.hasOwnProperty("lvState")&&(e=b.lvState,
d.activityStatus=e+"");b.hasOwnProperty("lvType")&&(d.lvType=b.lvType+"");if(1==e||f.config.hasOwnProperty("endToLiveback")&&f.config.endToLiveback&&3==e)f.videoSetting.refresh(d),this.dispatchEvent(new Event(LoadEvent.LOADCMP,[b,a]));else{f={code:ERR.INTERRUPT};switch(e+""){case "2":f={code:ERR.INTERRUPT};break;case "3":f={code:ERR.END};break;case "0":f={code:ERR.NOSTART}}f.message=LiveGlobalHandler.liveInfoMap[e];this.dispatchEvent(new Event(LoadEvent.LOADERROR,[f,a]))}}};a.prototype.loadError=
function(b,a){this.isClose||this.dispatchEvent(new Event(LoadEvent.LOADERROR,[{code:ERR.ACTIVITY_TIMEOUT,errInfo:"url:"+this.getUrl()},a]))};return a}(),LiveIdProxy=function(){function a(b){this.model=b}var b=["//183.247.178.242/v3","//111.206.211.222/v3","//106.39.244.240/v3"];ClassTool.inherits(a,Proxy);a.prototype.getRequestList=function(){for(var a=[],c="https://api-live.lecloud.com/liveVideo/getLvPlayInfo?ver=v0.1&playType=2&keyType=1",f=["liveId","domain","p","customerId"],d=0;d<f.length;d++){var e=
f[d];this.model.config.hasOwnProperty(e)?c="domain"==e?c+("&key="+this.model.config[e]):c+("&"+e+"="+this.model.config[e]):this.model.videoSetting.hasOwnProperty(e)&&(c+="&"+e+"="+this.model.videoSetting[e])}if(this.model.config.hasOwnProperty("utoken")&&this.model.config.hasOwnProperty("cuid"))c+="&utoken="+this.model.config.utoken,c+="&cuid="+this.model.config.cuid;else if(this.model.config.hasOwnProperty("callbackJs")){var g;videoSdkTool.isFunction(WIN[this.model.config.callbackJs])&&(g=WIN[this.model.config.callbackJs](PlayerEvent.USER_INFO));
g&&g.hasOwnProperty("utoken")&&g.hasOwnProperty("cuid")&&(c+="&utoken="+g.utoken,c+="&cuid="+g.cuid)}c+="&clientType=4";a.push({url:c,timeout:5E3,maxCount:3,retryTime:0});for(d=0;d<b.length;d++)-1!=a[0].url.indexOf("//api.live.letvcloud.com/v3")&&(f=c.replace("//api.live.letvcloud.com/v3",b[d]),a.push({url:f,timeout:5E3,maxCount:3,retryTime:0}));return a};a.prototype.loadCmp=function(b,a){if(!this.isClose){b=BaseCode.utf8to16(BaseCode.decode(b.value));b=jsonTool.stringToJson(b);this.log("liveid data"+
jsonTool.jsonToString(b)+"----time:"+jsonTool.jsonToString(a));var f=this.model,d={};d.userId=b.customerId;f.userData.refresh(d);d={};d.liveId=b.liveId;this.model.config.hasOwnProperty("activityId")||(d.ark=0,d.hasAd=!1,d.pic="",d.isdrm=0,f.playerConfig.refresh({mloadingUrl:"",loadingUrl:"",logo:{pic:"",pos:"",url:""}}));var e={},g=!1;this.model.defaultDefinitionList=[];f.liveback=!1;f.config.hasOwnProperty("activityId")&&f.videoSetting.hasOwnProperty("activityStatus")&&3==f.videoSetting.activityStatus&&
(f.liveback=!0);for(var h=0;h<b.streams.length;h++){var l=b.streams[h];if(!f.liveback&&1==l.streamState||f.liveback&&0<l.streamState)e.hasOwnProperty(l.rateType)||(e[l.rateType]={},e[l.rateType].videoWidth=l.width,e[l.rateType].videoHeight=l.height,e[l.rateType].sid=l.streamId,e[l.rateType].definition=l.rateName,e[l.rateType].vtype=l.rateType,e[l.rateType].urls=[]),e[l.rateType].urls.push(l.streamUrl),this.model.defaultDefinitionList.push(l.rateType),g=!0}g?(d.defaultDefinition=this.model.defaultDefinitionList[0],
d.media=e,f.videoSetting.refresh(d),this.dispatchEvent(new Event(LoadEvent.LOADCMP,[b,a]))):(f=b.streams[0],d={code:ERR.INTERRUPT},0==f.streamState?d={code:ERR.NOSTART}:2==f.streamState?d={code:ERR.INTERRUPT}:3==f.streamState&&(d={code:ERR.END}),d.message=LiveGlobalHandler.liveInfoMap[f.streamState],d.errInfo="url:"+this.getUrl()+" respponse:"+jsonTool.jsonToString(b),this.dispatchEvent(new Event(LoadEvent.LOADERROR,[d,a])))}};a.prototype.loadError=function(b,a){this.isClose||this.dispatchEvent(new Event(LoadEvent.LOADERROR,
[{code:ERR.LIVE_IO,errInfo:"url:"+this.getUrl()},a]))};return a}(),StreamIdProxy=function(){function a(b){this.model=b}var b=["//183.247.178.242/v3","//111.206.211.222/v3","//106.39.244.240/v3"];ClassTool.inherits(a,LiveIdProxy);a.prototype.getRequestList=function(){for(var a=[],c="http://api.live.letvcloud.com/v3/rtmp/rtmplive/playInfo?playType=2&keyType=1",f=["streamId","domain"],d=0;d<f.length;d++){var e=f[d];this.model.config.hasOwnProperty(e)&&(c="domain"==e?c+("&key="+this.model.config[e]):
c+("&"+e+"="+this.model.config[e]))}c+="&clientType=4";a.push({url:c,timeout:5E3,maxCount:3,retryTime:0});for(d=0;d<b.length;d++)-1!=a[0].url.indexOf("//api.live.letvcloud.com/v3")&&(f=c.replace("//api.live.letvcloud.com/v3",b[d]),a.push({url:f,timeout:5E3,maxCount:3,retryTime:0}));return a};return a}(),ActStatusProxy=function(){function a(b){this.model=b;this.needLiveId=!0}var b=["//106.39.244.239/","//111.206.211.221/","//223.95.79.18/"];ClassTool.inherits(a,Proxy);a.prototype.getRequestList=function(){var a=
[],c="https://api-live.lecloud.com/liveVideo/getLvStatus?ver=v0.1",f=["activityId","liveId","streamId"];this.needLiveId||(f=["activityId"]);for(var d=0;d<f.length;d++){var e=f[d];this.model.config.hasOwnProperty(e)?c="activityId"==e?c+("&lvId="+this.model.config[e]):c+("&"+e+"="+this.model.config[e]):this.model.videoSetting.hasOwnProperty(e)&&(c="activityId"==e?c+("&lvId="+this.model.videoSetting[e]):c+("&"+e+"="+this.model.videoSetting[e]))}c+="&clientType=4";a.push({url:c,timeout:5E3,maxCount:3,
retryTime:0});for(d=0;d<b.length;d++)-1!=a[0].url.indexOf("//api.live.letvcloud.com/")&&(f=c.replace("//api.live.letvcloud.com/",b[d]),a.push({url:f,timeout:5E3,maxCount:3,retryTime:0}));return a};a.prototype.loadCmp=function(b,a){this.isClose||(this.log("\u76f4\u64ad\u72b6\u6001\u63a5\u53e3\u8fd4\u56de\uff1a"+b),b.hasOwnProperty("errCode")||b.hasOwnProperty("lvState")&&this.dispatchEvent(new Event(LoadEvent.LOADCMP,[b.lvState,a])))};return a}(),HttpDNSProxy=function(){function a(b){this.model=b;
this.requestType=2}var b=[];ClassTool.inherits(a,Proxy);a.prototype.getRequestList=function(){var a=[];a.push({url:"https://hdns.lecloud.com/d?dn=r.gslb.lecloud.com",timeout:2E3,maxCount:2,retryTime:0});for(var c=0;c<b.length;c++)if(-1!=a[0].url.indexOf(replace)){var f="https://hdns.lecloud.com/d?dn=r.gslb.lecloud.com".replace(replace,b[c]);a.push({url:f,timeout:2E3,maxCount:2,retryTime:0})}return a};a.prototype.loadCmp=function(b,a){this.isClose||this.dispatchEvent(new Event(LoadEvent.LOADCMP,[b,
a]))};a.prototype.loadError=function(b,a){this.isClose||this.dispatchEvent(new Event(LoadEvent.LOADERROR,[{code:ERR.ACTIVITY_TIMEOUT,errInfo:"url:"+this.getUrl()},a]))};return a}(),GslbProxy=function(){function a(b){this.model=b}ClassTool.inherits(a,Proxy);a.prototype.getRequestList=function(){var b=[],a=videoSdkTool.clone(this.model.videoSetting.urls);videoSdkTool.addUrlParams(a,{format:1,expect:3});for(var c=0;c<a.length;c++){var f=this.checkGslbUrl(a[c]);b.push({url:f,timeout:1E4,maxCount:3,retryTime:0})}return b};
a.prototype.checkGslbUrl=function(b){"ios"==this.model.vodPlayType&&-1==b.indexOf("&tss=ios&")&&(b=-1!=b.indexOf("&tss=no&")?b.replace("&tss=no&","&tss=ios&"):b+"&tss=ios");"mp4"==this.model.vodPlayType&&-1==b.indexOf("&tss=no&")&&(b=-1!=b.indexOf("&tss=ios&")?b.replace("&tss=ios&","&tss=no&"):b+"&tss=no");return b};a.prototype.loadCmp=function(b,a){if(!this.isClose)if(this.log("gslb data:"+jsonTool.jsonToString(b)+" time"+jsonTool.jsonToString(a)),200==b.status){b.ercode="0";for(var c=[b.location],
f=0;f<b.nodelist.length;f++)b.nodelist[f].location!=c[0]&&c.push(b.nodelist[f].location);this.dispatchEvent(new Event(LoadEvent.LOADCMP,c))}else this.dispatchEvent(new Event(LoadEvent.LOADERROR,[{code:ERR.GSLB_ANALY,message:"\u8c03\u5ea6\u9519\u8bef"},a]))};a.prototype.loadError=function(b,a){this.isClose||this.dispatchEvent(new Event(LoadEvent.LOADERROR,[{code:ERR.GSLB_IO,errInfo:"url:"+this.getUrl()},a]))};return a}(),Reporter=function(){function a(){this.lastTime=this.pt=0;this.isStartPlay=this.isPauseRecord=
!1;this.state="";this.replaytype=1}function b(b){this.model=b;this.reset()}var k={envUrl:"http://apple.www.letv.com/env/",playUrl:"http://apple.www.letv.com/cloud_pl/",erUrl:"http://apple.www.letv.com/er/",VERSION:"3.0.5",heartTime:18E4},c={pc:{value:30,sub:{value:300}},sdk:{value:32,sub:{value:321,ios:{value:321,domain:"https://apple-www.le.com"},android:{value:322}}},html5:{value:31,sub:{value:310,ios:{value:311},android:{value:312},pc:{value:310}}},wx:{value:31,sub:{value:310,ios:{value:311},android:{value:312},
pc:{value:310}}}},f={android:600,ios:601};b.prototype={init:function(){this.model.reportParam.p1=3;this.model.reportParam.p2=c[this.model.platform.toLowerCase()].value;c[this.model.platform.toLowerCase()].sub.hasOwnProperty(this.model.systemData.os.toLowerCase())?(this.replaceDomain(c[this.model.platform.toLowerCase()].sub[this.model.systemData.os.toLowerCase()]),this.model.reportParam.p3=c[this.model.platform.toLowerCase()].sub[this.model.systemData.os.toLowerCase()].value):this.model.reportParam.p3=
c[this.model.platform.toLowerCase()].sub.value},replaceDomain:function(b){if(b.hasOwnProperty("domain"))for(var a in k)"string"==typeof k[a]&&("http"===b.domain.substr(0,4)?k[a]=k[a].replace(/^http:\/\/apple.www.letv.com/g,b.domain):k[a]=k[a].replace(/apple.www.letv.com/g,b.domain))},reset:function(){this.heartTimer&&(this.heartTimer.stop(),this.heartTimer=null);this.reportParam=new a},onStateChanged:function(b,a){a=jsonTool.stringToJson(a);logTool.log("[Stat K \u65e5\u5fd7\u6570\u636e]  type:"+b+
" data:"+a);switch(b){case "init":this.reportParam.isStartPlay=!1;this.model.init(a);this.init();this.sendEnvStat();break;case "start":this.reportParam.isStartPlay=!1;this.sendPlayStat("init");break;case "play":this.reportParam.isStartPlay||(this.sendPlayStat("play",a),this.startHeartTimer(),this.resumePtStat(),this.reportParam.isStartPlay=!0);break;case "bufferEmpty":this.reportParam.state!=b&&this.reportParam.isStartPlay&&(this.pausePtStat(),this.sendPlayStat("block"));break;case "bufferFull":"bufferEmpty"==
this.reportParam.state&&this.reportParam.isStartPlay&&(this.resumePtStat(),this.sendPlayStat("eblock"));this.reportParam.isStartPlay||(this.reportParam.isStartPlay=!0);break;case "seek":this.reportParam.isStartPlay&&(this.pausePtStat(),this.sendPlayStat("drag",{py:{dr:this.model.videoInfo().time+"_"+a.time}}));break;case "pause":this.reportParam.state!=b&&this.reportParam.isStartPlay&&(this.pausePtStat(),this.sendPlayStat("pa"));break;case "resume":this.reportParam.isStartPlay&&this.resumePtStat();
break;case "definition":this.reportParam.isStartPlay&&(this.pausePtStat(),this.model.videoSetting.definitionCount++,this.reportParam.replaytype=2,this.sendPlayStat("tg"));break;case "stopPlay":this.reportParam.isStartPlay&&(this.reportParam.isStartPlay=!1,this.pausePtStat(),this.pauseHeadStat(),this.sendPlayStat("end"));break;case "playStop":this.reportParam.isStartPlay&&(this.reportParam.isStartPlay=!1,this.pauseHeadStat(),this.sendPlayStat("end"),this.sendPlayStat("finish"));break;case "hide":null!=
this.heartTimer&&this.reportParam.isStartPlay&&(this.pausePtStat(!0),this.heartTimer.stop());break;case "show":null!=this.heartTimer&&this.reportParam.isStartPlay&&(this.resumePtStat(!0),this.heartTimer.start());break;case "error":this.reportParam.isStartPlay=!1,this.sendErrorStat(a),null!=this.heartTimer&&this.heartTimer.stop()}this.reportParam.state=b},startHeartTimer:function(){this.heartTimer?this.heartTimer.running||(this.setDelay(),this.heartTimer.start()):(this.heartTimer=new Timer(k.heartTime,
this,this.heartHanlder),this.setDelay(),this.heartTimer.start())},pauseHeadStat:function(){this.heartHanlder();this.heartTimer&&this.heartTimer.stop()},setDelay:function(){if(this.heartTimer)switch(this.heartTimer.currentCount){case 0:this.heartTimer.delay=15E3;break;case 1:this.heartTimer.delay=6E4;break;default:this.heartTimer.delay=k.heartTime}},heartHanlder:function(){this.pausePtStat(!0);this.resumePtStat(!0);this.setDelay();this.sendPlayStat("time");this.reportParam.pt=0},pausePtStat:function(b){"undefined"==
typeof b&&(b=!1);var a=videoSdkTool.now();this.reportParam.isPauseRecord||0==this.reportParam.lastTime||(this.reportParam.pt+=a-this.reportParam.lastTime);0==this.reportParam.lastTime&&(this.reportParam.pt=0);this.reportParam.lastTime=a;b||(this.reportParam.isPauseRecord=!0)},resumePtStat:function(b){"undefined"==typeof b&&(b=!1);var a=videoSdkTool.now();this.reportParam.lastTime=a;b||(this.reportParam.isPauseRecord=!1)},sendEnvStat:function(){var b=k.envUrl,a=this.model,b=b+("?ver="+k.VERSION),b=
b+("&p1="+this.model.reportParam.p1),b=b+("&p2="+this.model.reportParam.p2),b=b+("&p3="+this.model.reportParam.p3);if("html5"==this.model.platform||"wx"==this.model.platform)b+="&lc="+a.lc();"sdk"==this.model.platform&&(b+="&auid="+a.auid());b+="&uuid="+a.uuid();b+="&mac="+a.systemData.mac;b+="&nt="+a.systemData.nt;b+="&os="+a.systemData.os;b+="&osv="+a.systemData.osv;b+="&app="+a.systemData.appv;b+="&bd="+encodeURIComponent(a.systemData.bd);b+="&xh="+encodeURIComponent(a.systemData.xh);b+="&ro="+
encodeURIComponent(a.systemData.ro);b=b+"&src=pl"+("&ch="+a.getTypeFrom());b+="&cs="+encodeURIComponent(a.systemData.cs);b+="&ssid="+encodeURIComponent(a.systemData.ssid);b+="&lo="+encodeURIComponent(a.systemData.lo);b+="&la="+encodeURIComponent(a.systemData.la);b+="&apprunid="+a.apprunid();b+="&r="+Math.random();this.report(b)},sendPlayStat:function(b,a){var c=k.playUrl,h=this.model,c=c+("?ver="+k.VERSION),c=c+("&p1="+this.model.reportParam.p1),c=c+("&p2="+this.model.reportParam.p2),c=c+("&p3="+
this.model.reportParam.p3),c=c+("&ac="+b)+("&prg="+h.videoInfo().time);"time"==b&&(18E4<this.reportParam.pt&&(this.reportParam.pt=18E4),0>this.reportParam.pt&&(this.reportParam.pt=0),c+="&pt="+Math.abs(Math.round(0.001*this.reportParam.pt)));if("html5"==this.model.platform||"wx"==this.model.platform)c+="&lc="+h.lc();"sdk"==this.model.platform&&(c+="&auid="+h.auid());c+="&uuid="+h.uuid();"vod"==h.playType&&(c+="&cid="+h.videoSetting.cid,""!=h.videoSetting.pid&&(c+="&pid="+h.videoSetting.pid),c+="&vid="+
h.videoSetting.vid,c+="&ty=0",c+="&vlen="+h.videoSetting.duration);"live"==h.playType&&(c+="&lid="+h.videoSetting.lid,c+="&sid="+h.videoSetting.sid,c+="&ty=1",c+="&vlen=6000",h.videoSetting.hasOwnProperty("activityId")&&(c+="&zid="+h.videoSetting.activityId));c+="&ch="+h.getTypeFrom();c+="&vt="+h.videoSetting.vtype;c+="&pv="+encodeURIComponent(this.model.systemData.appv);"sdk"==this.model.platform&&(a||(a={}),a.hasOwnProperty("py")||(a.py={}),a.py.replaytype=this.reportParam.replaytype);this.model.videoSetting.hasOwnProperty("p")&&
(a||(a={}),a.hasOwnProperty("py")||(a.py={}),a.py.p=this.model.videoSetting.p);null!=a&&a.hasOwnProperty("py")&&(c+="&py="+encodeURIComponent(videoSdkTool.objectParseToString(a.py)));"sdk"==this.model.platform&&(c+="&pcode="+this.model.pcode(),c+="&nt="+h.systemData.nt);c+="&ap="+this.model.config.autoplay;"init"==b&&"sdk"==this.model.platform&&(c+="&cdev="+h.systemData.cdev,c+="&caid="+f[h.systemData.os.toLowerCase()]);"play"==b&&(c+="&pay=0",a&&a.hasOwnProperty("cv")&&(c+="&stc="+encodeURIComponent(videoSdkTool.objectParseToString(a.cv.stc)),
c+="&joint="+a.cv.joint));c+="&prl=0";c+="&ctime="+videoSdkTool.now();c+="&custid="+h.userInfo().userId;c+="&ipt=0";c+="&owner=1";c+="&apprunid="+h.apprunid();"sdk"!=this.model.platform&&(c+="&url="+encodeURIComponent(window?window.location.href:""),c+="&ref="+encodeURIComponent(document?document.referrer:""));c+="&r="+Math.random();this.report(c)},sendErrorStat:function(b){var a=k.erUrl,c=this.model,a=a+("?ver="+k.VERSION),a=a+("&p1="+this.model.reportParam.p1),a=a+("&p2="+this.model.reportParam.p2),
a=a+("&p3="+this.model.reportParam.p3),a=a+"&et=pl"+("&err="+b.errcode);if("html5"==this.model.platform||"wx"==this.model.platform)a+="&lc="+c.lc();"sdk"==this.model.platform&&(a+="&auid="+c.auid());a+="&mac="+c.systemData.mac;a+="&nt="+c.systemData.nt;a+="&os="+c.systemData.os;a+="&osv="+c.systemData.osv;a+="&app="+c.systemData.appv;a+="&bd="+c.systemData.bd;a+="&xh="+c.systemData.xh;a+="&ro="+c.systemData.ro;"vod"==c.playType&&(a+="&cid="+c.videoSetting.cid,""!=c.videoSetting.pid&&(a+="&pid="+c.videoSetting.pid),
a+="&vid="+c.videoSetting.vid);"live"==c.playType&&(a+="&lid="+c.videoSetting.lid,a+="&sid="+c.videoSetting.sid);b={ch:c.getTypeFrom(),custid:c.userInfo().userId};this.model.videoSetting.hasOwnProperty("p")&&(b.p=this.model.videoSetting.p);for(var f=["uu","vu","liveId","streamId","activityId"],l=0;l<f.length;l++)c.config.hasOwnProperty(f[l])&&(b[f[l]]=c.config[f[l]]);a+="&ep="+encodeURIComponent(videoSdkTool.objectParseToString(b));a+="&ap="+c.config.autoplay;a+="&uuid="+c.uuid();a+="&apprunid="+
c.apprunid();a+="&r="+Math.random();this.report(a)},report:function(b){b=DomainTool.getDomain(b,this.model.config.lang,this.isMustHttps());logTool.log("[Stat K]  url:"+b);switch(this.model.platform){case "html5":var a=new Image(1,1);a.onload=a.onerror=a.onabort=function(){a=a.onload=a.onerror=a.onabort=null};a.src=b;break;case "wx":wx.request({url:b});break;case "sdk":ExternalInterface.callSDK(this.model.systemData.os,"logRequest",{url:b})}},isMustHttps:function(){return"wx"==this.model.platform||
"sdk"==this.model.platform?!0:!1}};return b}(),ModelHandler=function(){function a(b){this.model=b}ClassTool.inherits(a,ClassObject);a.prototype.setUp=function(b,a){if(this.model.config.hasOwnProperty("url")){var c=new UrlProxy(this.model);c.addEventListener(LoadEvent.LOADCMP,this.gpcCmp,this);c.load()}else b.hasOwnProperty("uu")&&b.hasOwnProperty("vu")?(this.model.vodPlayType="ios",this.vodproxy="101"==this.model.videoSetting.p?new CloudVodProxy(this.model):new CloudMmsProxy(this.model),this.vodproxy.addEventListener(LoadEvent.LOADCMP,
this.gpcCmp,this),this.vodproxy.addEventListener(LoadEvent.LOADERROR,this.errorHanlder,this),this.vodproxy.load()):this.dispatchEvent(new Event(LoadEvent.LOADERROR,[{code:ERR.PARAMS}]))};a.prototype.destroy=function(b){this.vodproxy&&this.vodproxy.unload()};a.prototype.errorHanlder=function(b){this.dispatchEvent(new Event(LoadEvent.LOADERROR,b.args[1]))};a.prototype.gpcCmp=function(b){this.refreshLoadingData(b);this.dispatchEvent(new Event(LoadEvent.LOADCMP,b))};a.prototype.refreshLoadingData=function(){this.model.config.hasOwnProperty("loadingurl")&&
(this.model.playerConfig.mloadingUrl=0==this.model.config.loadingurl?this.model.playerConfig.loadingUrl:this.model.config.loadingurl)};return a}(),LiveModelHandler=function(){function a(b){this.model=b;this.DelayT=0;this.isComplete=this.getUrlsList=!1}var b={"r.gslb.lecloud.com":""};ClassTool.inherits(a,ClassObject);a.prototype.setUp=function(a,c){if(this.model.config.hasOwnProperty("url")){b["r.gslb.lecloud.com"]=["r.gslb.lecloud.com"];var f=new UrlProxy(this.model);f.addEventListener(LoadEvent.LOADCMP,
this.dataCmp,this);f.load()}else this.getUrlsList=!1,a.hasOwnProperty("activityId")?this.requestDataByActiveId():a.hasOwnProperty("liveId")?this.requestDataByLiveId():a.hasOwnProperty("streamId")?this.requestDataByStreamId():this.dispatchEvent(new Event(LoadEvent.LOADERROR,[{code:ERR.PARAMS}]))};a.prototype.requestDataByLiveId=function(b){b=new LiveIdProxy(this.model);b.addEventListener(LoadEvent.LOADCMP,this.dataCmp,this);b.addEventListener(LoadEvent.LOADERROR,this.errorHanlder,this);b.load()};a.prototype.requestDataByStreamId=
function(b){b=new StreamIdProxy(this.model);b.addEventListener(LoadEvent.LOADCMP,this.dataCmp,this);b.addEventListener(LoadEvent.LOADERROR,this.errorHanlder,this);b.load()};a.prototype.requestDataByActiveId=function(b){b=new ActiveIdProxy(this.model);b.addEventListener(LoadEvent.LOADCMP,this.activeCmp,this);b.addEventListener(LoadEvent.LOADERROR,this.errorHanlder,this);b.load()};a.prototype.activeCmp=function(b){this.requestDataByLiveId()};a.prototype.activeConfig=function(b){b=new ConfigProxy(this.model);
b.addEventListener(LoadEvent.LOADCMP,this.configCmp,this);b.load()};a.prototype.configCmp=function(b){this.requestDataByLiveId()};a.prototype.errorHanlder=function(b){this.dispatchEvent(new Event(LoadEvent.LOADERROR,b.args[1]))};a.prototype.dataCmp=function(b){this.isComplete=!1;this.getUrlsList=!0;this.refreshUrlsData.call(this)};a.prototype.destroy=function(){};a.prototype.refreshLoadingData=function(){this.model.config.hasOwnProperty("loadingurl")&&(this.model.playerConfig.mloadingUrl=0==this.model.config.loadingurl?
this.model.playerConfig.loadingUrl:this.model.config.loadingurl)};a.prototype.refreshUrlsData=function(){this.DelayT&&clearTimeout(this.DelayT);if(!this.isComplete){this.isComplete=!0;if(""!=b["r.gslb.lecloud.com"])for(var a in this.model.videoSetting.media){for(var c=[],f=0;f<this.model.videoSetting.media[a].urls.length;f++)for(var d=0;d<b["r.gslb.lecloud.com"].length;d++)if(""!=b["r.gslb.lecloud.com"][d]){var e=this.model.videoSetting.media[a].urls[f].replace("r.gslb.lecloud.com",b["r.gslb.lecloud.com"][d]);
c.push(e)}0<c.length&&(this.model.videoSetting.media[a].urls=c)}this.dispatchEvent(new Event(LoadEvent.LOADCMP))}};return a}(),BasePlayer=function(){function a(){}ClassTool.inherits(a,ClassObject);a.prototype.init=function(){this.playUrlList=[];this.isFtc=this.startPlay=this.autoplay=!1;this.playState=0;this.render=null;this.emptyDelay=1E3};a.prototype.setConfig=function(b){};a.prototype.errorHandler=function(b){1<this.playUrlList.length&&b&&b.code&&4!=b.code?(this.playUrlList.shift(),this.log("\u64ad\u653e\u5931\u8d25\uff0c errCode:"+
b.code+",\u5207\u6362\u4e0b\u4e00\u4e2a\u5730\u5740:"+this.playUrlList[0]),this.changeurl(this.playUrlList[0])):(b.hasOwnProperty("retryCdn")||(b.retryCdn=!0),b.hasOwnProperty("code")||(b.code=ERR.PLAY_TIMEOUT),this.log("\u64ad\u653e\u5931\u8d25: errCode:"+b.code+",url:"+this.playUrlList[0]),this.dispatchEvent(new Event(MediaEvent.EVENT,MediaEvent.ERROR,[b])))};a.prototype.onPlaySeekHandler=function(){this.emptyST&&clearTimeout(this.emptyST);this.startPlay&&(this.playState=5,this.dispatchEvent(new Event(MediaEvent.EVENT,
MediaEvent.SEEK,this.getTime())))};a.prototype.onPlayFullHandler=function(){this.startPlay||(this.startPlay=!0,this.dispatchEvent(new Event(MediaEvent.EVENT,MediaEvent.START)),this.render&&this.render.start());1!=this.playState&&(this.playState=1,this.dispatchEvent(new Event(MediaEvent.EVENT,MediaEvent.BUFFEREFULL,this.getTime())));this.emptyST&&clearTimeout(this.emptyST)};a.prototype.onPlayEmptyHandler=function(){var b=this;b.emptyST&&clearTimeout(b.emptyST);b.startPlay&&3!=b.playState&&(5!=b.playState?
(b.playState=3,b.emptyST=setTimeout(function(){b.dispatchEvent(new Event(MediaEvent.EVENT,MediaEvent.BUFFEREMPTY,b.getTime()))},b.emptyDelay)):(b.playState=3,b.dispatchEvent(new Event(MediaEvent.EVENT,MediaEvent.SEEKEMPTY,b.getTime()))))};a.prototype.onPlaStopHandler=function(){this.emptyST&&clearTimeout(this.emptyST);4!=this.playState&&(this.playState=4,this.dispatchEvent(new Event(MediaEvent.EVENT,MediaEvent.STOP,!0)))};a.prototype.onPlayHandler=function(){this.emptyST&&clearTimeout(this.emptyST);
this.playState=1;this.dispatchEvent(new Event(MediaEvent.EVENT,MediaEvent.PLAY,this.getTime()))};a.prototype.onPauseHandler=function(){this.emptyST&&clearTimeout(this.emptyST);this.playState=2;this.dispatchEvent(new Event(MediaEvent.EVENT,MediaEvent.PAUSE,this.getTime()))};a.prototype.onPlayIngHandler=function(){var b=this.getTime();0<=b&&!this.isFtc&&(this.log("\u7b2c\u4e00\u6b21\u83b7\u5f97\u975e0\u7684\u64ad\u653e\u65f6\u95f4"+b),this.isFtc=!0,this.onPlayFullHandler());this.startPlay&&this.dispatchEvent(new Event(MediaEvent.EVENT,
MediaEvent.PLAYING,b))};a.prototype.onLoadIngHandler=function(){this.dispatchEvent(new Event(MediaEvent.EVENT,MediaEvent.LODING,this.getLoadPercent()))};a.prototype.onMetaDataHandler=function(b){this.videoWidth=b.width||0;this.videoHeight=b.height||0;!this.mduration||0!=b.duration&&isFinite(b.duration)||(b.duration=this.mduration);0<this.videoWidth&&0<this.videoHeight&&!this.hasMetadata&&(this.setSize(),this.hasMetadata=!0,this.dispatchEvent(new Event(MediaEvent.EVENT,MediaEvent.METADATA,{videoWidth:this.videoWidth,
videoHeight:this.videoHeight,duration:this.duration})));0<b.duration&&isFinite(b.duration)&&this.duration!=b.duration&&(this.duration=b.duration,this.dispatchEvent(new Event(MediaEvent.EVENT,MediaEvent.DURATION,{duration:this.duration})))};return a}(),H5SamplePlayer=function(){function a(){var b=this;this.type="video";this._videoRect={};this.videoUuid=videoSdkTool.creatUuid();this.videoHandlerBack=function(){b.videoHandler.apply(b,arguments)}}ClassTool.inherits(a,BasePlayer);a.prototype.destroy=function(){};
a.prototype.setPoster=function(b){};a.prototype.setUp=function(b,a,c){this.video=a;this.config=b;this.page=c;this.isEndStartSeek=0<this.config.start?!1:!0;b.hasOwnProperty("autoplay")&&"1"==b.autoplay?this.autoplay=!0:this.autoplay=!1;this.isShow=!0;this.renderType="";this._videoRect={x:0,y:0,width:400,height:300}};a.prototype.enableControls=function(){this.page.setData({controls:!0})};a.prototype.disableControls=function(){this.page.setData({controls:!1})};a.prototype.setContainer=function(b){this.vArea=
b};a.prototype.setLoop=function(b){};a.prototype.hide=function(b){this.page.setData({BCLVideoHidden:!0});this.isShow=!1};a.prototype.show=function(){this.isShow||this.page.setData({BCLVideoHidden:!1})};a.prototype.setSize=function(){this.display=0<this.outEl.offsetWidth&0<this.outEl.offsetHeight?!0:!1;this.setVideoRect();this.render&&this.render.setSize(this.vArea.offsetWidth,this.vArea.offsetHeight)};a.prototype.setVideoRect=function(){};a.prototype.addEvents=function(){var b=this;this.funKey={};
this.funKey.BCLtimeUpdateKey="update_"+this.videoUuid;this.funKey.BCLplayKey="play_"+this.videoUuid;this.funKey.BCLpauseKey="pause"+this.videoUuid;this.funKey.BCLendKey="end"+this.videoUuid;this.page[this.funKey.BCLtimeUpdateKey]=function(a){b.currentTime=a.detail.currentTime;b.duration=a.detail.duration;b.onPlayIngHandler();if(!b.startPlay)b.onMetaDataHandler({duration:b.duration});b.autoSeek();if(b.isEndStartSeek)b.onPlayFullHandler();b.isStartSeek&&(b.isEndStartSeek=!0)};this.page[this.funKey.BCLplayKey]=
function(a){b.onPlayHandler()};this.page[this.funKey.BCLpauseKey]=function(a){b.onPauseHandler()};this.page[this.funKey.BCLendKey]=function(a){b.onPlaStopHandler()};this.page.setData({BCLtimeUpdate:this.funKey.BCLtimeUpdateKey,BCLplay:this.funKey.BCLplayKey,BCLpause:this.funKey.BCLpauseKey,BCLend:this.funKey.BCLpauseKey})};a.prototype.autoSeek=function(){var b=this;0!=b.config.start?b.startPlay||b.isEndStartSeek?b.isStartSeek=!0:setTimeout(function(){b.isStartSeek=!0;b.seek(b.config.start)},500):
b.isStartSeek=!0};a.prototype.getLoadPercent=function(){if(this.video.getLoadPercent)return this.video.getLoadPercent();for(var b=this.video.buffered,a=0;a<b.length;a++)if(this.getTime()<b.end(a))return Math.min(1,b.end(a)/this.video.duration);return 0};a.prototype.play=function(b){this.renderType=b.type;this.hasMetadata=!1;this.playUrlList=b.urls;this.config.start=b.start;this.url=this.playUrlList[0];this.isEndStartSeek=0<this.config.start?!1:!0;this.isFtc=this.startPlay=this.isStartSeek=!1;this.log("\u6e32\u67d3\u5f15\u64ce\u521d\u59cb\u5316\u5b8c\u6bd5\uff0c\u56de\u8c03\u64ad\u653e, url:"+
this.url);this.prePlay(this.url,this.autoplay||b.play,b)};a.prototype.prePlay=function(b,a,c){this.addEvents();this.duration=c.mduration;this.currentTime=0;this.page.setData({src:this.url})};a.prototype.resume=function(b){this.video.play();b&&b()};a.prototype.pause=function(){this.video.pause()};a.prototype.getTime=function(){return this.currentTime||0};a.prototype.seek=function(b){this.video.seek(b);this.currentTime=b};a.prototype.changeurl=function(b){this.url=b;this.page.setData({src:this.url});
this.config.start=this.getTime();this.isEndStartSeek=0<this.config.start?!1:!0;this.resume()};a.prototype.setVol=function(b){this.vol=b};a.prototype.getVol=function(){return this.vol};a.prototype.stop=function(){this.destroy()};a.prototype.getVideoRect=function(b){this._videoRect.hasMetadata=this.hasMetadata;return this._videoRect};return a}(),MediaPlayer=function(){function a(b){this.init(b)}ClassTool.inherits(a,ClassObject);a.prototype.init=function(b){this.time=0;this.config=b};a.prototype.setUp=
function(b,a,c){var f=videoSdkTool.clone(this.config),d=["pic","volume"];this.loop=!1;this.el=a;this.volume=b.volume;for(var e=0;e<d.length;e++){var g=d[e];!f.hasOwnProperty(g)&&b.hasOwnProperty(g)&&(f[g]=b[g])}this.creatPlayer(f,a,c)};a.prototype.creatPlayer=function(b,a,c){this.player&&(this.player.removeEventListener(MediaEvent.EVENT,this.MediaHanlder,this),this.player.destroy(),this.player=null);this.player=this.getPlayer(b);this.player.init();this.player.setUp(b,a,c)};a.prototype.setMedia=function(b){};
a.prototype.hide=function(b){this.player.hide(b)};a.prototype.show=function(){this.player.show()};a.prototype.setConfig=function(b){};a.prototype.setContainer=function(b){null!=b&&this.player.setContainer(b)};a.prototype.getPlayer=function(b){return new H5SamplePlayer};a.prototype.startPlay=function(b){var a={start:0,play:!1,type:"",callback:null},c;for(c in a)b.hasOwnProperty(c)||(b[c]=a[c]);this.destroy();this.setVol(this.volume);this.player.addEventListener(MediaEvent.EVENT,this.MediaHanlder,this);
this.player.mduration=b.duration;this.player.play(b)};a.prototype.setSize=function(){this.player.setSize()};a.prototype.play=function(b){this.player.resume(b)};a.prototype.setVol=function(b){this.player.setVol(b);this.volume=b;this.dispatchEvent(new Event(MediaEvent.EVENT,MediaEvent.VOL,b))};a.prototype.pause=function(){this.player.pause()};a.prototype.destroy=function(){this.closeVideo();this.loop=!1;this.player.setLoop(!1);this.player.destroy()};a.prototype.closeVideo=function(){this.player.removeEventListener(MediaEvent.EVENT,
this.MediaHanlder,this);this.player.stop()};a.prototype.getTime=function(){return parseInt(this.player.getTime())};a.prototype.seek=function(b){0<=b&&0>=b-this.player.duration&&(this.player.seek(b),b<this.player.duration&&this.player.resume())};a.prototype.getBufferPercent=function(b){return 1};a.prototype.getLoadPercent=function(b){return this.player.getLoadPercent()};a.prototype.setLoop=function(b){this.loop=b;this.player.setLoop(b)};a.prototype.MediaHanlder=function(b){switch(b.args[1]){case MediaEvent.STOP:if(this.loop){this.seek(0);
return}}this.dispatchEvent(b)};a.prototype.changeurl=function(b){this.player.changeurl(b)};a.prototype.getVideoRect=function(b){return this.player.getVideoRect(b)};a.prototype.replay=function(){this.player.seek(0);this.dispatchEvent(new Event(MediaEvent.EVENT,MediaEvent.REPLAY,this.getTime()))};a.prototype.getVideoEl=function(){return this.player.videoEL};a.prototype.setPoster=function(b){return this.player.setPoster(b)};return a}(),PlayUrlProxy=function(){function a(b){this.model=b}ClassTool.inherits(a,
ClassObject);a.prototype.translate=function(){this.gslbLoader=new GslbProxy(this.model);this.model.videoSetting.gslb?(this.gslbLoader.addEventListener(LoadEvent.LOADCMP,this.gslbCmp,this),this.gslbLoader.addEventListener(LoadEvent.LOADERROR,this.gslbErr,this),this.gslbLoader.load()):this.dispatchEvent(new Event(LoadEvent.LOADCMP,this.leUrlsHandler()))};a.prototype.gslbCmp=function(b){this.dispatchEvent(new Event(LoadEvent.LOADCMP,b.args[1]))};a.prototype.gslbErr=function(b){this.dispatchEvent(new Event(LoadEvent.LOADCMP,
this.leUrlsHandler()))};a.prototype.leUrlsHandler=function(b){b=videoSdkTool.clone(this.model.videoSetting.urls);for(var a=0;a<b.length;a++)b[a]=this.gslbLoader.checkGslbUrl(b[a]);return b};return a}(),ReportPlayer=function(){function a(){this.superClass.constructor.apply(this,arguments)}ClassTool.inherits(a,Control);a.prototype.init=function(b,a){this.facade=b;this.model=a;this.model.record={};this.reportApi=new Reporter(a);this.reportApi.onStateChanged("init",{deviceId:this.model.lc(),os:videoSdkTool.getOs(),
osv:videoSdkTool.getOsv(),width:videoSdkTool.getScreenWidth(),height:videoSdkTool.getScreenHeight(),appv:this.model.playerConfig.version})};a.prototype.setUp=function(b,a){this.model.config.report&&(this.model.videoSetting.errCode=0,this.facade.addEventListener(PlayerEvent.EVENT,this.videoSateHandler,this))};a.prototype.destroy=function(){this.model.config.report&&(this.superClass.destroy.apply(this,arguments),this.reportApi.reset(),this.facade.removeEventListener(PlayerEvent.EVENT,this.videoSateHandler,
this))};a.prototype.videoSateHandler=function(b){if(this.model.config.report)switch(b.args[1]){case PlayerEvent.VIDEO_DATA_CMP:0!=this.model.record.ms&&(this.model.record.mr=videoSdkTool.now()-this.model.record.ms,this.model.record.ms=0);this.reportApi.onStateChanged("start",{});break;case MediaEvent.BUFFEREMPTY:this.reportApi.onStateChanged("bufferEmpty");break;case MediaEvent.BUFFEREFULL:this.reportApi.onStateChanged("bufferFull");break;case MediaEvent.PLAY:this.reportApi.onStateChanged("resume");
break;case MediaEvent.START:0!=this.model.record.vs&&(this.model.record.pr=videoSdkTool.now()-this.model.record.vs,this.model.record.vs=0);this.reportApi.onStateChanged("play",{cv:{stc:{mr:this.model.record.mr,adr:this.model.record.adr,pr:this.model.record.pr,gslbr:this.model.record.gslbr},joint:this.model.joint}});break;case MediaEvent.STOP:if(b.args[2])this.reportApi.onStateChanged("playStop");else this.reportApi.onStateChanged("stopPlay");break;case MediaEvent.PAUSE:this.reportApi.onStateChanged("pause");
break;case MediaEvent.SEEK:this.reportApi.onStateChanged("seek",{time:b.args[2]});break;case PlayerEvent.VPH:this.reportApi.onStateChanged("hide");break;case PlayerEvent.VPS:this.reportApi.onStateChanged("show");break;case MediaEvent.DEFSTART:this.reportApi.onStateChanged("definition");break;case PlayerEvent.ERROR:case MediaEvent.ERROR:b=b.args[2][0];this.model.videoSetting.errCode=b.code;this.reportApi.onStateChanged("error",{errcode:b.code});this.report({logcontent:b.errInfo||""});break;case AdEvent.HEADEND:case AdEvent.NOAD:0!=
this.model.record.as&&(this.model.record.adr=videoSdkTool.now()-this.model.record.as,this.model.record.as=0);this.model.record.vs=videoSdkTool.now();break;case PlayerEvent.VIDEO_DATA_START:this.model.record.ms=videoSdkTool.now();break;case PlayerEvent.GSLB_START:this.model.record.gslbs=videoSdkTool.now();break;case PlayerEvent.GSLB_CMP:0!=this.model.record.gslbs&&(this.model.record.gslbr=videoSdkTool.now()-this.model.record.gslbs,this.model.record.gslbs=0),this.model.record.vs=videoSdkTool.now()}};
a.prototype.report=function(b){var a=this.model.videoSetting.errCode;b&&b.hasOwnProperty("code")&&(a=b.code);var c={ver:"1.0"};c.uuid=this.model.uuid();c.ec=a;c.p3="h5";c.cvid="vod"==this.model.playType?this.model.videoSetting.vid:this.model.videoSetting.sid;c.vtyp=this.model.playType;c.mtyp="cloud";c.cuid=this.model.userData.userId;c.leid=this.model.lc();c.pver=this.model.playerConfig.version;c.type=1;c.logcontent="";for(var f in b)c[f]=b[f];ReportTool.report("http://log.cdn.letvcloud.com/sdk/epl",
c)};a.prototype.showLog=function(){ReportTool.print(logTool.getLog(),this.model.lc())};a.prototype.getLog=function(){return logTool.getLog()};return a}(),AdCtrl=function(){function a(){this.superClass.constructor.apply(this,arguments)}ClassTool.inherits(a,Control);a.prototype.setUp=function(b,a){this.facade.dispatchEvent(new Event(AdEvent.EVENT,AdEvent.NOAD,"skip"))};return a}(),SkinPlayer=function(){function a(){this.superClass.constructor.apply(this,arguments)}ClassTool.inherits(a,Control);a.prototype.setUp=
function(b,a,c){this.el={};this.el.page=c;this.el.page.setData({BCLid:this.model.systemData.videoDomId});this.el.video=wx.createVideoContext(this.model.systemData.videoDomId);this.facade.addEventListener(PlayerEvent.EVENT,this.videoSateHandler,this)};a.prototype.load=function(b){this.dispatchEvent(new Event(LoadEvent.LOADCMP))};a.prototype.getVideArea=function(){return this.el.video};a.prototype.autoSize=function(){};a.prototype.setSize=function(){};a.prototype.addEvents=function(){};a.prototype.removeEvents=
function(){};a.prototype.destroy=function(){this.shutDown();this.skinView&&(this.facade.removeEventListener(PlayerEvent.EVENT,this.videoSateHandler,this),this.skinView.removeEventListener(SkinEvent.EVENT,this.skinHandler,this),this.skinView=null)};a.prototype.skinHandler=function(b){this.facade.dispatchEvent(b)};a.prototype.shutDown=function(){this.skinView&&this.skinView.shutDown()};a.prototype.videoSateHandler=function(b){b.args[1]!==MediaEvent.LODING&&b.args[1]!=MediaEvent.PLAYING&&this.log(b.args[1]);
switch(b.args[1]){case MediaEvent.CONNECT:var a=this;b="LoadingOK"+videoSdkTool.creatUuid();a.el.page[b]=function(b){b=b.detail;a.el.page.setData({BCLLoadingHidden:!1,BCLLoadingStyle:"width:"+b.width+"px;height:"+b.height+"px;margin-left:-"+b.width/2+"px;margin-top:-"+b.height/2+"px;"})};a.el.page.setData({BCLLoadingSrc:this.model.playerConfig.mloadingUrl,BCLLoadingHidden:!0,BCLLoadingOnLoad:b});break;case MediaEvent.START:this.el.page.setData({BCLLoadingHidden:!0})}};a.prototype.setVideoPercent=
function(b){};a.prototype.setVideoScale=function(b){};a.prototype.setVideoRect=function(b){};a.prototype.refreshPlayerInfo=function(b){this.skinView&&this.skinView.refreshPlayerInfo(b)};return a}(),VideoPlayer=function(){function a(){this.superClass.constructor.apply(this,arguments)}ClassTool.inherits(a,Control);a.prototype.setUp=function(b,a,c){this.log("\u5f00\u59cb\u521b\u5efa\u89c6\u9891\u6a21\u5757");this.el=a;this.page=c;this.mediaPlayer=new MediaPlayer(this.getConfig());this.model.videoSetting.volume=
0.8;this.model.videoSetting.fullscreen=!1;this.setDefinitionList();this.getDefaultConfig(this.model.config);this.changeVideoInfo(this.definition);this.mediaPlayer.setUp(this.model.videoSetting,a,c);this.page.setData({BCLVBoxStyle:"background-color:"+this.facade.color.colorConfig.bgColor+";",BCLVideoHidden:!1});this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.INIT))};a.prototype.getConfig=function(b){b=videoSdkTool.clone(this.model.config);switch(b.posterType){case "-1":case "-2":break;
default:b.autoplay="1",b.pic=""}return b};a.prototype.changeVideoInfo=function(b){this.videoInfo=videoSdkTool.clone(this.model.videoSetting.media[b]);this.videoInfo.definitionName=this.videoInfo.definition;this.videoInfo.definition=b;this.videoInfo.duration=this.model.videoSetting.duration;b={uuid:this.model.uuid(),p1:this.model.reportParam.p1,p2:this.model.reportParam.p2,p3:this.model.reportParam.p3};this.model.videoSetting.hasOwnProperty("liveId")&&(b.liveid=this.model.videoSetting.liveId,this.videoInfo.lid=
this.model.videoSetting.liveId);this.model.videoSetting.hasOwnProperty("vid")&&(b.vid=this.model.videoSetting.vid);b.ajax=1;videoSdkTool.addUrlParams(this.videoInfo.urls,b);this.model.videoSetting.refresh(this.videoInfo)};a.prototype.setDefinitionList=function(){var b=[],a=this.model,c;for(c in a.videoSetting.media)b.push(c);a.definition2TypeObj={};GlobalHandler.initTypeDefObj(a.defaultDefinitionList,a.definition2TypeObj);b.sort(function(b,a){return GlobalHandler.defList.indexOf(GlobalHandler.type2Def(b))-
GlobalHandler.defList.indexOf(GlobalHandler.type2Def(a))});a.videoSetting.refresh({definitionList:b})};a.prototype.getDefaultConfig=function(b){this.definition=this.model.videoSetting.defaultDefinition||this.model.videoSetting.definitionList[0];b.hasOwnProperty("rate")&&(b.rate=GlobalHandler.def2Type(b.rate,this.model.definition2TypeObj));b.hasOwnProperty("rate")&&-1!=this.model.videoSetting.definitionList.indexOf(b.rate)&&(this.definition=b.rate);this.startime=0;b.hasOwnProperty("start")&&(this.startime=
b.start)};a.prototype.setSize=function(b,a,c){this.mediaPlayer.setSize()};a.prototype.showPoster=function(b){var a=this;a.hidePoster();a.poster=null;a.mediaPlayer.hide(!1);a.addPoster();if(this.model.config.skinnable||a.model.config.controls){this.render();var c="playBigBtn"+videoSdkTool.creatUuid();this.page[c]=function(b){delete a.page[c];a.startAuth.call(a)};this.page.setData({BCLplayBigBtnClk:c})}};a.prototype.render=function(){var b=wx.createCanvasContext("BCLPlayBtn");b.beginPath();b.arc(40,
40,37,0,2*Math.PI,!0);b.closePath();b.setFillStyle(UiTool.hexToRgba(this.facade.color.colorConfig.fault,0.5).toLowerCase());b.fill();b.lineWidth=1;b.setStrokeStyle(UiTool.hexToRgba(this.facade.color.colorConfig.active,1).toLowerCase());b.beginPath();b.moveTo(32,25);b.lineTo(55,40);b.lineTo(32,55);b.closePath();b.stroke();b.setFillStyle(UiTool.hexToRgba(this.facade.color.colorConfig.active,1).toLowerCase());b.fill();b.draw()};a.prototype.hidePoster=function(b){this.page.setData({BCLPosterHidden:!0})};
a.prototype.addPoster=function(b){this.page.setData({BCLPosterHidden:!1,BCLPosterSrc:this.getPosterUrl()})};a.prototype.startAuth=function(b){this.hidePoster();this.mediaPlayer.show();this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.VIDEO_AUTH_VALID))};a.prototype.startPlay=function(b){this.log("\u5f00\u59cb\u5c1d\u8bd5\u64ad\u653e");this.isStartPlay=!1;this.setDefinitionList();this.getDefaultConfig(this.model.config);this.mediaPlayer.addEventListener(MediaEvent.EVENT,this.mediaHandler,
this);this.facade.addEventListener(SkinEvent.EVENT,this.skinSateHandler,this);this.facade.addEventListener(PlayerEvent.EVENT,this.videoSateHandler,this);this.mediaPlayer.setContainer(b);this.mediaPlayer.setLoop(this.model.config.loop);this.playVideo(this.start);this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,MediaEvent.CONNECT))};a.prototype.startGslb=function(b){this.gslbplayTime=b;this.gslbLoader=new PlayUrlProxy(this.model);this.gslbLoader.addEventListener(LoadEvent.LOADCMP,this.gslbCmp,
this);this.gslbLoader.addEventListener(LoadEvent.LOADERROR,this.gslbErr,this);this.gslbLoader.translate();this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.GSLB_START))};a.prototype.gslbCmp=function(b){this.videoInfo.urls=b.args[1];this.model.config.onlyPic?(this.mediaPlayer.show(),setTimeout(videoSdkTool.bindFun(this.play,this),10)):this.play()};a.prototype.play=function(){var b=this,a=!0;0!=b.model.joint||b.isStartPlay||-2!=b.model.config.posterType||(a="1"==b.model.config.autoplay);
b.mediaPlayer.startPlay({urls:b.videoInfo.urls,duration:b.videoInfo.duration,start:b.gslbplayTime,play:a,type:b.getPlayerType(),useHls:!1,callback:function(){b.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.GSLB_CMP))}});b.mediaPlayer.setLoop(this.model.config.loop)};a.prototype.gslbErr=function(b){this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.ERROR,b.args[2]))};a.prototype.setAutoReplay=function(b){this.mediaPlayer.setLoop(b)};a.prototype.setDefinition=function(b){this.definition!=
b&&-1!=this.model.videoSetting.definitionList.indexOf(b)&&(this.log("\u5207\u6362\u7801\u6d41-----------------------------"+b),this.definition=b,this.isStartPlay=!1,b=0,"vod"==this.model.playType&&(b=this.mediaPlayer.getTime()),this.playVideo(b),this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,MediaEvent.DEFSTART)))};a.prototype.playVideo=function(b){"pano"!=this.getPlayerType()||videoSdkTool.checkPano()?(this.changeVideoInfo(this.definition),this.startGslb(b)):this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,
PlayerEvent.VIDEO_INFO,[{code:490,message:"\u8be5\u8bbe\u5907\u8fd8\u4e0d\u652f\u63013d\u529f\u80fd,\u5efa\u8bae\u4f7f\u7528windows\u548c\u5b89\u5353\u7cfb\u7edf\u4e0b\u7684\u8c37\u6b4c\u6d4f\u89c8\u5668\u4f53\u9a8c\u8be5\u529f\u80fd"}]))};a.prototype.getDefinitionList=function(){return this.model.videoSetting.definitionList};a.prototype.videoSateHandler=function(b){switch(b.args[1]){case PlayerEvent.VPH:this.isStartPlay&&this.mediaPlayer.pause();break;case MediaEvent.START:this.isStartPlay=!0;this.mediaPlayer.show();
break;case MediaEvent.STOP:this.isStartPlay=!1;break;case PlayerEvent.ERROR:case MediaEvent.ERROR:this.isStartPlay=!1;case PlayerEvent.VIDEO_INFO:this.model.config.skinnable&&this.mediaPlayer.hide(!1);break;case PlayerEvent.FULLSCREEN:this.model.config.onlyPic&&!this.model.videoSetting.fullscreen&&this.mediaPlayer.hide();break;case PlayerEvent.PRESIZE:this.setSize();break;case MediaEvent.METADATA:this.setSize()}};a.prototype.skinSateHandler=function(b){switch(b.args[1]){case SkinEvent.PLAY:this.mediaPlayer.play();
break;case SkinEvent.PAUSE:this.mediaPlayer.pause();break;case SkinEvent.SEEK:this.mediaPlayer.seek(b.args[2]);break;case SkinEvent.VOLUME:this.model.videoSetting.volume=b.args[2];this.mediaPlayer.setVol(this.model.videoSetting.volume);break;case SkinEvent.SETDEFINITION:this.setDefinition(b.args[2]);break;case SkinEvent.REPLAY:this.mediaPlayer.replay()}};a.prototype.getPlayerType=function(){return this.model.config.hasOwnProperty("pano")&&"1"==this.model.config.pano||"1"==this.model.videoSetting.pano?
"pano":""};a.prototype.mediaHandler=function(b){switch(b.args[1]){case MediaEvent.ERROR:if("vod"==this.model.playType&&this.model.vodPlayType&&"ios"==this.model.vodPlayType&&b.args[2][0].retryCdn){this.model.vodPlayType="mp4";videoSdkTool.setLocal("playType",this.model.vodPlayType);this.log("\u91cd\u65b0\u8c03\u5ea6");this.startGslb(0);return}}this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,b.args[1],b.args[2]))};a.prototype.getPosterUrl=function(b){return this.model.config.hasOwnProperty("pic")?
this.model.config.pic:this.model.videoSetting.hasOwnProperty("pic")?this.model.videoSetting.pic:""};a.prototype.destroy=function(b){this.facade.removeEventListener(SkinEvent.EVENT,this.skinSateHandler,this);this.facade.removeEventListener(PlayerEvent.EVENT,this.videoSateHandler,this);this.mediaPlayer.removeEventListener(MediaEvent.EVENT,this.mediaHandler,this);this.mediaPlayer.destroy();this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,MediaEvent.STOP,!1))};a.prototype.refreshPlayerInfo=function(b){};
return a}(),GlobalPlayer=function(){function a(){this.superClass.constructor.apply(this,arguments)}ClassTool.inherits(a,Control);a.prototype.setUp=function(b){this.player=b;this.addEvents()};a.prototype.addEvents=function(){var b=this;b.addVideoEvent=!1;b.facade.addEventListener(SkinEvent.EVENT,b.skinSateHandler,b);b.facade.addEventListener(PlayerEvent.EVENT,b.videoSateHandler,b);b.fullChangeFun=videoSdkTool.bindFun(b.fullChange,b);b.resizeFun=videoSdkTool.bindFun(b.resize,b);UiTool.addEvent(document,
"fullscreenchange,webkitfullscreenchange,mozfullscreenchange,MSFullscreenChange",b.fullChangeFun);UiTool.addEvent(window,"resize",this.resizeFun);UiTool.addEvent(window,"pagehide",videoSdkTool.bindFun(this.pageHide,this));var a;["webkit","moz","o","ms"].forEach(function(b){"undefined"!=typeof document[b+"Hidden"]&&(a=b)});UiTool.addEvent(document,a+"visibilitychange",function(){"hidden"==document[a+"VisibilityState"]?b.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.VPH)):"visible"==
document[a+"VisibilityState"]&&b.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.VPS))})};a.prototype.videoSateHandler=function(b){switch(b.args[1]){case PlayerEvent.INIT:this.addVideoEvents()}};a.prototype.pageHide=function(b){this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.WPH))};a.prototype.fullChange=function(){this.model.videoSetting&&(this.model.videoSetting.fullscreen=UiTool.isFullScreen(),this.model.videoSetting.fullscreen||(this.cancelFullscreen(),this.resizeFun()),
this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.FULLSCREEN,this.model.videoSetting.fullscreen)))};a.prototype.resize=function(){this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.PRESIZE))};a.prototype.cancelFullscreen=function(){var b=this.player.skinplugin.skin;b.hasAttribute("tmpStyle")&&(b.setStyle({cssText:b.getAttribute("tmpStyle")}),b.removeAttribute("tmpStyle"));this.bodyTmpOverFlow&&(document.body.style.overflow=this.bodyTmpOverFlow)};a.prototype.addVideoEvents=
function(b){b=this.player.videoplugin.mediaPlayer.getVideoEl();var a=this;a.addVideoEvent||(b.addEventListener("webkitbeginfullscreen",function(){a.model.videoSetting.fullscreen=!0;a.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.FULLSCREEN,a.model.videoSetting.fullscreen))}),b.addEventListener("webkitendfullscreen",function(){a.model.videoSetting.fullscreen=!1;a.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.FULLSCREEN,a.model.videoSetting.fullscreen));a.resizeFun()}),
a.addVideoEvent=!0)};a.prototype.skinSateHandler=function(b){switch(b.args[1]){case SkinEvent.FULLSCREEN:b=this.player.videoplugin.mediaPlayer.getVideoEl();if(this.model.config.dfull&&b&&b.webkitEnterFullscreen&&"chrome"!=videoSdkTool.getBrowser()){b.webkitEnterFullscreen();break}this.model.videoSetting.fullscreen?(this.model.videoSetting.fullscreen=!1,this.cancelFullscreen(),UiTool.supportFullScreen()&&this.model.config.dfull&&UiTool.cancelFullScreen()):(this.model.videoSetting.fullscreen=!0,this.player.skinplugin.skin.setAttribute({tmpStyle:this.player.skinplugin.el.style.cssText}),
UiTool.supportFullScreen()&&this.model.config.dfull?UiTool.fullScreen(this.player.skinplugin.el):(this.bodyTmpOverFlow=document.body.style.overflow,document.body.style.overflow="hidden"),this.player.skinplugin.skin.setStyle({cssText:"background: #000;width:100%;height:100%;position:fixed;top:0;left:0;z-index:1000;overflow:hidden;"}));this.resizeFun()}};return a}(),ErrorPlayer=function(){function a(){this.superClass.constructor.apply(this,arguments)}ClassTool.inherits(a,Control);a.prototype.setUp=
function(b,a,c){this.el=a;this._api=c;this.skin=new DisplayObject(this.el);this.playingStop=!1;this.error=null;this.facade.addEventListener(PlayerEvent.EVENT,this.videoSateHandler,this)};a.prototype.videoSateHandler=function(b){switch(b.args[1]){case MediaEvent.START:case MediaEvent.BUFFEREFULL:this.skin.setVisible(!1);break;case MediaEvent.ERROR:case PlayerEvent.ERROR:case PlayerEvent.VIDEO_INFO:this.skin.setVisible(!0);if(!this.model.config.skinnable)break;this.show(b.args[2]);break;case MediaEvent.STOP:this.playingStop=
!0;this.skin.setVisible(!1);break;case MediaEvent.PLAYING:this.playingStop&&this.skin.setVisible(!1);this.playingStop=!1;break;case PlayerEvent.VIDEO_LIVESTOP:this.playingStop=!0}};a.prototype.show=function(b){var a=this;a.error?a.error.show(b,a.el,{api:a._api,model:a.model}):SOTool.getPlugin("ErrorInfo",function(c){c&&(a.error=new c,a.error.show(b,a.el,{api:a._api,model:a.model}))})};a.prototype.report=function(){};return a}(),H5Sdk=function(){function a(a){this._pl=a}a.prototype.playNewId=function(a){return this._pl.playNewId(a)};
a.prototype.getVideoSetting=function(){for(var a=videoSdkTool.clone(this._pl.model.videoSetting),k={},c=0;c<GlobalHandler.settingList().length;c++){var f=GlobalHandler.settingList()[c];a.hasOwnProperty(f)?k[f]="definition"==f?this.getDefinition():"defaultDefinition"==f?this.getDefaultDefinition():a[f]:k[f]=""}return k};a.prototype.getVideoTime=function(){return this._pl.videoplugin?this._pl.videoplugin.mediaPlayer.getTime():0};a.prototype.pauseVideo=function(){this._pl.facade.dispatchEvent(new Event(SkinEvent.EVENT,
SkinEvent.PAUSE))};a.prototype.resumeVideo=function(){this._pl.facade.dispatchEvent(new Event(SkinEvent.EVENT,SkinEvent.PLAY))};a.prototype.seekTo=function(a){this._pl.facade.dispatchEvent(new Event(SkinEvent.EVENT,SkinEvent.SEEK,a))};a.prototype.replayVideo=function(){this._pl.facade.dispatchEvent(new Event(SkinEvent.EVENT,SkinEvent.REPLAY))};a.prototype.closeVideo=function(){this._pl.closeVideo()};a.prototype.setVolume=function(a){this._pl.facade.dispatchEvent(new Event(SkinEvent.EVENT,SkinEvent.VOLUME,
a))};a.prototype.startUp=function(){this._pl.startUp()};a.prototype.setDefinition=function(a){a=GlobalHandler.def2Type(a,this._pl.model.definition2TypeObj);this._pl.facade.dispatchEvent(new Event(SkinEvent.EVENT,SkinEvent.SETDEFINITION,a))};a.prototype.getDefinition=function(){return GlobalHandler.type2Def(this._pl.model.videoSetting.definition)};a.prototype.getDefaultDefinition=function(){return GlobalHandler.type2Def(this._pl.model.videoSetting.defaultDefinition)};a.prototype.getDefList=function(){for(var a=
[],k=0;k<this._pl.model.defaultDefinitionList.length;k++){var c=GlobalHandler.type2Def(this._pl.model.defaultDefinitionList[k]);a.push(c)}return a};a.prototype.getVideoPercent=function(){};a.prototype.setVideoScale=function(a){this._pl.skinplugin.setVideoScale(a);return 0};a.prototype.getVideoScale=function(){return 0};a.prototype.getLoadPercent=function(){if(this._pl.videoplugin)return this._pl.videoplugin.mediaPlayer.getLoadPercent()};a.prototype.getPlayRecord=function(){if(this._pl.videoplugin)return this._pl.videoplugin.getPlayRecord()};
a.prototype.getVersion=function(){return this._pl.version};a.prototype.feedback=function(a){return this._pl.feedback(a)};a.prototype.getLog=function(a){return this._pl.getLog(a)};return a}(),PlayerConf={configConver:function(a,b){var k={report:!0,dfull:!0,fullscreen:!0,skinnable:!0,controls:!1,loop:!1,definition:!0,autoSize:"0",changeParent:!1,posterType:"1",playsinline:"1",autoplay:"0",onlyPic:!1,playIngBg:!1,dvideoSize:!0,mustAutoplay:!1,next:!1,setBtn:!1,seek:!0,share:!1,controlBarVisible:!0,bigPlayBtnVisible:!0,
lang:"zh_CN",pageControls:!1,endToLiveback:!1};a.setBtn=!1;a.share=!1;a.hasOwnProperty("pa")&&(a.pano=a.pa,delete a.pa);a.hasOwnProperty("auto_play")&&(a.autoplay=a.auto_play,delete a.auto_play);a.hasOwnProperty("autoReplay")&&(a.loop="1"==a.autoReplay,delete a.autoReplay);a.hasOwnProperty("url")&&(a.report=!1,a.nskin=7,a.definition=!1);0>parseInt(a.posterType)&&!a.hasOwnProperty("controls")&&!a.hasOwnProperty("skinnable")&&(a.controls="1",a.skinnable="0");b.skinnable=1;b.controls=1;for(var c in a)b[c]=
a[c];for(c in k)a.hasOwnProperty(c)?"boolean"==typeof k[c]&&(a[c]="1"==a[c]):a[c]=k[c];if(1<parseInt(a.autoplay)||0>parseInt(a.autoplay))a.autoplay="0";if(3<parseInt(a.posterType)||-2>parseInt(a.posterType))a.posterType="1";a.autoplay+="";a.posterType+="";a.onlyPic=!1;a.playIngBg=!0}},BaseH5Player=function(){function a(){this.init()}ClassTool.inherits(a,ClassObject);a.prototype.init=function(){this.api=new H5Sdk(this)};a.prototype.setUp=function(a,k,c){this.vModelInit=this.canplay=!1;this.model=new Model;
this.setModelByEnv(k);this.model.api=this.getVideoApi();this.model.outConfig={};this.configHanlder(a,this.model.outConfig);this.model.config.refresh(a);this.model.playerConfig.refresh({version:this.version});this.initPlugin();this.facade=new Facade;this.facade.init(this.model.config);this.facade.wxPage=c;this.reportplugin=new ReportPlayer(this.facade,this.model);this.reportplugin.setUp();this.skinplugin=new SkinPlayer(this.facade,this.model);this.skinplugin.setUp(a,k,c);this.addEvents();this.envCheck()&&
this.startGetData()};a.prototype.initPlugin=function(){};a.prototype.envCheck=function(){return!0};a.prototype.setModelByEnv=function(){switch(videoSdkTool.getDevice()){case "pc":case "mac":this.model.systemData.refresh({pc:!0});break;default:this.model.systemData.refresh({pc:!1})}};a.prototype.configHanlder=function(a,k){PlayerConf.configConver(a,k);a.hasOwnProperty("p")&&(this.model.videoSetting.p=a.p)};a.prototype.addEvents=function(){this.facade.addEventListener(SkinEvent.EVENT,this.skinHandler,
this);this.facade.addEventListener(PlayerEvent.EVENT,this.videoHandler,this)};a.prototype.removedEvents=function(){this.facade.removeEventListener(SkinEvent.EVENT,this.skinHandler,this);this.facade.removeEventListener(PlayerEvent.EVENT,this.videoHandler,this)};a.prototype.startGetData=function(){this.log("\u5f00\u59cb\u8bf7\u6c42\u6570\u636e");this.vModel="vod"==this.model.playType?new ModelHandler(this.model):new LiveModelHandler(this.model);this.vModel.addEventListener(LoadEvent.LOADCMP,this.dataCmp,
this);this.vModel.addEventListener(LoadEvent.LOADERROR,this.errorHanlder,this);this.vModel.setUp(this.model.config,this.skinplugin);this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.VIDEO_DATA_START))};a.prototype.dataCmp=function(){this.log("\u8bf7\u6c42GpC\u6210\u529f");var a=this;"0"==a.model.videoSetting.isdrm?(a.setupPlayer(),a.vModelInit=!0,a.skinplugin.addEventListener(LoadEvent.LOADCMP,function(){"0"==a.model.config.autoplay?a.videoplugin.showPoster():a.videoplugin.startAuth()},
this),a.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.VIDEO_DATA_CMP)),a.skinplugin.load()):a.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.ERROR,[{code:ERR.VOD_CONFIG_DRM,message:Message.Drm}]))};a.prototype.setupPlayer=function(){this.log("\u5f00\u59cb\u521b\u5efa\u64ad\u653e\u5668");this.videoplugin||(this.videoplugin=new VideoPlayer(this.facade,this.model),this.videoplugin.setUp(this.model.videoSetting,this.skinplugin.el.video,this.skinplugin.el.page))};a.prototype.creatVideo=
function(){this.log("\u5f00\u59cb\u521b\u5efa\u89c6\u9891");this.videoplugin.startPlay(this.skinplugin.getVideArea())};a.prototype.setupAdplugin=function(){this.log("\u5f00\u59cb\u8bf7\u6c42\u5e7f\u544a");this.adplugin=new AdCtrl(this.facade,this.model);this.facade.addEventListener(AdEvent.EVENT,this.adHandler,this);this.adplugin.setUp(this.videoplugin.mediaPlayer,this.skinplugin.el)};a.prototype.errorHanlder=function(a){this.log("\u6570\u636e\u8bf7\u6c42\u5931\u8d25");this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,
PlayerEvent.ERROR,a.args[1]))};a.prototype.adHandler=function(a){this.log("\u5e7f\u544a\u8fd4\u56de"+a.args[1]);switch(a.args[1]){case AdEvent.HEADSTART:this.model.joint=2;this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,AdEvent.HEADSTART));break;case AdEvent.HEADEND:this.model.joint=2;case AdEvent.NOAD:this.model.joint=0,this.facade.removeEventListener(AdEvent.EVENT,this.adHandler,this),this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,a.args[1],a.args[2])),this.creatVideo()}};a.prototype.videoHandler=
function(a){this.vStateHandler(a);switch(a.args[1]){case PlayerEvent.VIDEO_AUTH_VALID:this.canplay=!0;this.setupAdplugin();break;case PlayerEvent.VIDEO_DATA_START:case PlayerEvent.GSLB_START:case PlayerEvent.GSLB_CMP:case PlayerEvent.VIDEO_DATA_CMP:case MediaEvent.PLAYING:case MediaEvent.LODING:return;case PlayerEvent.INIT:"0"!=this.model.config.autoSize&&this.skinplugin.autoSize();this.model.playerConfig.refresh({pWidth:this.skinplugin.el.offsetWidth,pHeight:this.skinplugin.el.offsetHeight});break;
case PlayerEvent.WPH:this.destroy();return}var k=a.args[1];a=a.args[2];k==PlayerEvent.ERROR&&(k=MediaEvent.ERROR);this.dispatchEvent(new Event(PlayerEvent.EVENT,k,a));this.model.config.hasOwnProperty("callbackJs")&&WIN[this.model.config.callbackJs]&&WIN[this.model.config.callbackJs](k,a)};a.prototype.vStateHandler=function(a){};a.prototype.skinHandler=function(a){};a.prototype.destroy=function(){this.skinplugin&&this.skinplugin.shutDown();this.globalplugin&&this.globalplugin.destroy();this.videoplugin&&
this.videoplugin.destroy();this.removedEvents();this.vModel&&(this.vModel.destroy(),this.vModel=null);this.adplugin&&(this.adplugin.destroy(),this.adplugin=null);this.reportplugin&&this.reportplugin.destroy()};a.prototype.closeVideo=function(){this.videoplugin.destroy()};a.prototype.shutDown=function(){this.destroy();this.addEvents();this.videoplugin&&this.videoplugin.showPoster()};a.prototype.startUp=function(){this.log("call startUp -vModelInit:"+this.vModelInit);this.destroy();this.vModelInit?
(this.addEvents(),this.videoplugin&&this.videoplugin.startAuth()):(this.model.config.autoplay="1",this.reportplugin.setUp(),this.addEvents(),this.startGetData())};a.prototype.playNewId=function(a){var k="";this.destroy();this.model.clear();this.setModelByEnv();this.model.playerConfig.refresh({version:this.version});try{var c=wx.getSystemInfoSync();this.model.init({deviceId:this.model.lc(),os:c.system.split(" ")[0],osv:c.system.split(" ")[1],width:c.windowWidth,height:c.windowHeight,appv:this.version})}catch(f){}this.vModelInit=
!1;this.canplay&&!a.hasOwnProperty("autoplay")&&(k="1");this.configHanlder(a,this.model.outConfig);""!=k&&(a.autoplay=k);this.model.config.refresh(a);this.reportplugin.setUp();this.addEvents();this.startGetData()};a.prototype.feedback=function(a){"undefined"==typeof a&&(a={});a.type="0";a.logcontent=api.getLog();this.reportplugin.report(a)};a.prototype.getLog=function(){return this.reportplugin.getLog()};a.prototype.getVideoApi=function(){var a=this;return{getVideoInfo:function(){return{time:a.videoplugin.mediaPlayer.getTime()}}}};
a.prototype.setPlayerInfo=function(a){var k={buttonColor:"fault",progressBarColor:"active"};if(a.hasOwnProperty("onoff")){for(var c in a.onoff)a[c]=a.onoff[c];delete a.onoff}for(c in a)k.hasOwnProperty(c)&&(a[k[c]]=a[c],delete a[c]),"boolean"==typeof this.model.config[c]&&(a[c]="1"==a[c]+"");k={};k.logo=a.logo;k.watermark=a.watermark;this.model.playerConfig.refresh(k);this.model.config.refresh(a);this.facade.color.refresh(a);this.skinplugin.refreshPlayerInfo(a);this.videoplugin.refreshPlayerInfo(a)};
return a}(),BvWXH5Player=function(){function a(){this.superClass.constructor.apply(this,arguments)}ClassTool.inherits(a,BaseH5Player);a.prototype.init=function(){this.superClass.init.apply(this,arguments);this.version="H5_Vod_20170113_1.0.0"};a.prototype.setModelByEnv=function(a){this.model.platform="wx";this.model.systemData.refresh({pc:!1,videoDomId:a});this.superClass.setModelByEnv.apply(this,arguments);this.model.videoSetting.p=101;this.model.playType="vod";this.model.videoSetting.gslb=!0};a.prototype.envCheck=
function(){return!0};return a}(),BlWXH5Player=function(){function a(){this.superClass.constructor.apply(this,arguments)}ClassTool.inherits(a,BaseH5Player);a.prototype.init=function(){this.superClass.init.apply(this,arguments);this.version="H5_Live_20170113_1.0.0";this.errCheck=null;this.checkTimer=new Timer(3E3,this,this.checkHanlder,1);this.checkLoopTimer=new Timer(6E4,this,this.checkLoopHanlder)};a.prototype.setUp=function(a,k,c){a.domain="localhost";this.superClass.setUp.apply(this,arguments)};
a.prototype.setModelByEnv=function(a){this.model.platform="wx";this.model.systemData.refresh({pc:!1,videoDomId:a});this.superClass.setModelByEnv.apply(this,arguments);this.model.playType="live";this.model.videoSetting.p=100;this.model.videoSetting.gslb=!1};a.prototype.configHanlder=function(a,k){a.progressBarVisible=!1;a.nskin=7;a.timeVisible=!1;this.superClass.configHanlder.apply(this,arguments)};a.prototype.startGetData=function(){this.superClass.startGetData.apply(this,arguments)};a.prototype.vStateHandler=
function(a){if(this.model.liveback)return!0;switch(a.args[1]){case MediaEvent.START:this.checkLoopTimer.start();break;case MediaEvent.PLAYING:this.removeCheck();this.checkTimer.reset();this.checkTimer.start();break;case MediaEvent.PAUSE:case MediaEvent.STOP:this.removeCheck(),this.checkTimer.reset()}return!0};a.prototype.checkHanlder=function(a){this.checkRequestList()&&(this.removeCheck(),this.lRequest=new ActStatusProxy(this.model),this.lRequest.addEventListener(LoadEvent.LOADCMP,this.checkActDataCmp,
this),this.lRequest.load(),this.log("\u5f00\u59cb\u8bf7\u6c42\u76f4\u64ad\u72b6\u6001\u63a5\u53e3"))};a.prototype.checkLoopHanlder=function(a){this.checkRequestList()&&(this.removeCheck(),this.lRequest=new ActStatusProxy(this.model),this.lRequest.addEventListener(LoadEvent.LOADCMP,this.checkActDataCmp,this),this.lRequest.needLiveId=!1,this.lRequest.load(),this.log("\u5f00\u59cb\u8bf7\u6c42\u6d3b\u52a8\u72b6\u6001\u63a5\u53e3"))};a.prototype.checkRequestList=function(){for(var a=["activityId","liveId",
"streamId"],k=0;k<a.length;k++){var c=a[k];if(this.model.config.hasOwnProperty(c)||this.model.videoSetting.hasOwnProperty(c))return!0}return!1};a.prototype.removeCheck=function(){this.lRequest&&(this.lRequest.removeEventListener(LoadEvent.LOADCMP,this.cheActDataCmp,this),this.lRequest.unload(),this.lRequest=null)};a.prototype.checkActDataCmp=function(a){this.log("\u76f4\u64ad\u72b6\u6001\u63a5\u53e3\u8fd4\u56de"+a.args[1][0]);switch(a.args[1][0]+""){case "2":"1"==this.model.videoSetting.activityStatus&&
(this.videoplugin&&this.videoplugin.mediaPlayer.closeVideo(),this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.VIDEO_INFO,[{code:ERR.INTERRUPT,message:LiveGlobalHandler.liveInfoMap[a.args[1][0]]}])),this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.VIDEO_INTERRUPT,{code:a.args[1][0]})));break;case "3":this.videoplugin&&this.videoplugin.mediaPlayer.closeVideo();this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.VIDEO_INFO,[{code:ERR.END,message:LiveGlobalHandler.liveInfoMap[a.args[1][0]]}]));
this.facade.dispatchEvent(new Event(PlayerEvent.EVENT,PlayerEvent.VIDEO_LIVESTOP,{code:a.args[1][0]}));this.checkLoopTimer.stop();this.checkTimer.stop();break;case "1":switch(this.model.videoSetting.activityStatus){case "2":this.resumeByInterrupt();break;case "3":this.resumeByInterrupt()}}this.model.videoSetting.activityStatus=a.args[1][0]};a.prototype.resumeByInterrupt=function(){this.videoplugin.startGslb(0)};return a}();
}
export function VodVideo(vc,id,page) {
    var VodSDK = new BvWXH5Player();
    VodSDK.setUp(vc,id,page);
    return VodSDK
}
export function LiveVideo(vc,id,page) {
    var LiveSDK = new BlWXH5Player();
    LiveSDK.setUp(vc,id,page);
    return LiveSDK
}